<!DOCTYPE html>
<html lang="ru">
<head>
        <meta charset="utf-8" />
        <title>–ù–µ–π—Ä–æ—Å–µ—Ç–∏ –¥–ª—è –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ - ¬´–ü–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω¬ª</title>
        <link rel="stylesheet" href="https://mazko.github.io/blog/theme/css/main.css" />
        <link href="https://mazko.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="üè† –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –í—Å–µ–≥–æ üöó Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://mazko.github.io/">üè† –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –í—Å–µ–≥–æ üöó </a></h1>
                <nav><ul>
                    <li><a href="https://mazko.github.io/blog/category/admin/">Admin</a></li>
                    <li><a href="https://mazko.github.io/blog/category/electronics/">Electronics</a></li>
                    <li class="active"><a href="https://mazko.github.io/blog/category/embedded/">Embedded</a></li>
                    <li><a href="https://mazko.github.io/blog/category/iot/">IoT</a></li>
                    <li><a href="https://mazko.github.io/blog/category/java/">Java</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://mazko.github.io/blog/posts/2021/03/28/neiroseti-dlia-mikrokontrollerov-pertseptron/" rel="bookmark"
           title="Permalink to –ù–µ–π—Ä–æ—Å–µ—Ç–∏ –¥–ª—è –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ - ¬´–ü–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω¬ª">–ù–µ–π—Ä–æ—Å–µ—Ç–∏ –¥–ª—è –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ - ¬´–ü–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω¬ª</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2021-03-28T00:00:00+02:00">
                –í—Å 28 –º–∞—Ä—Ç–∞ 2021
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://mazko.github.io/blog/author/oleg-mazko/">Oleg Mazko</a>
        </address>
<p>In <a href="https://mazko.github.io/blog/category/embedded/">Embedded</a>.</p>
<p>tags: <a href="https://mazko.github.io/blog/tag/msp430">msp430</a> <a href="https://mazko.github.io/blog/tag/ai">ai</a> </p>
</footer><!-- /.post-info -->      <p>–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ (–ò–ù–°) ‚Äî —ç—Ç–æ —É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π (–ë–ù–°). –ü–æ–∫–∞ —á—Ç–æ –ò–ù–° –µ—â–µ –æ—á–µ–Ω—å –¥–∞–ª–µ–∫–∏ –æ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –º–æ–∑–≥–∞ –∏ –º—ã—à–ª–µ–Ω–∏—è, –æ–¥–Ω–∞–∫–æ —É–∂–µ —Å–µ–π—á–∞—Å –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤–æ –º–Ω–æ–≥–∏—Ö —Å—Ñ–µ—Ä–∞—Ö –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–µ–ª–æ–≤–µ–∫–∞ —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ, –∞ —Ç–∞–∫–∂–µ —Å–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Ä–æ–±–æ—Ç—ã-–∫—É—Ä—å–µ—Ä—ã, –±–µ—Å–ø–∏–ª–æ—Ç–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç, –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –∏ –¥—Ä.</p>
<p>–ë–∞–∑–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ ‚Äî –Ω–µ–π—Ä–æ–Ω. –ö–∞–∫ –º—ã –≤–∏–¥–∏–º –Ω–∞ —Ä–∏—Å—É–Ω–∫–µ –Ω–∏–∂–µ, —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ –º–æ–∂–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –¥–æ —Å–ª–µ–¥—É—é—â–µ–π: –¥–µ–Ω–¥—Ä–∏—Ç—ã, —Ç–µ–ª–æ –Ω–µ–π—Ä–æ–Ω–∞ –∏ –∞–∫—Å–æ–Ω. –î–µ–Ω–¥—Ä–∏—Ç—ã ‚Äî –≤–µ—Ç–≤—è—â–∏–µ—Å—è –æ—Ç—Ä–æ—Å—Ç–∫–∏, —Å–æ–±–∏—Ä–∞—é—â–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å–æ –≤—Ö–æ–¥–∞ –≤ –Ω–µ–π—Ä–æ–Ω (—ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–Ω–µ—à–Ω—è—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å —Ä–µ—Ü–µ–ø—Ç–æ—Ä–æ–≤, –∏–ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç –¥—Ä—É–≥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞). –í —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –≤—Ö–æ–¥—è—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∞ –Ω–µ–π—Ä–æ–Ω (–≤ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º —Å–ª—É—á–∞–µ ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Å—Ç–∞–ª –≤—ã—à–µ –∫–∞–∫–æ–≥–æ-—Ç–æ –ø–æ—Ä–æ–≥–∞), —Ä–æ–∂–¥–∞–µ—Ç—Å—è –≤–æ–ª–Ω–∞ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ –º–µ–º–±—Ä–∞–Ω–µ —Ç–µ–ª–∞ –Ω–µ–π—Ä–æ–Ω–∞, –∞ –∑–∞—Ç–µ–º —á–µ—Ä–µ–∑ –∞–∫—Å–æ–Ω, –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º –≤—ã–±—Ä–æ—Å–∞ –Ω–µ–π—Ä–æ–º–µ–¥–∏–∞—Ç–æ—Ä–∞, –ø–µ—Ä–µ–¥–∞–µ—Ç —Å–∏–≥–Ω–∞–ª –¥—Ä—É–≥–∏–º –Ω–µ—Ä–≤–Ω—ã–º –∫–ª–µ—Ç–∫–∞–º–∏ –∏–ª–∏ —Ç–∫–∞–Ω—è–º.</p>
<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2021/03/28/neiroseti-dlia-mikrokontrollerov-pertseptron/neuron.png" style="width:100%; display:block; border:1px solid #ddd;"></p>
<p>–°–Ω–∞—á–∞–ª–∞ –±—É–¥–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏, –ø–æ—Ç–æ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∫–æ–¥.</p>
<h2>–¢–ï–û–†–ò–Ø</h2>
<p>–£–æ—Ä—Ä–µ–Ω –ú–∞–∫-–ö–∞–ª–ª–æ–∫ –∏ –£–æ–ª—Ç–µ—Ä –ü–∏—Ç—Ç—Å –≤ 1943 –≥–æ–¥—É –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∏ –º–æ–¥–µ–ª—å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞. –ê –≤ 1958 –≥–æ–¥—É –§—Ä–µ–Ω–∫ –†–æ–∑–µ–Ω–±–ª–∞—Ç—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–π—Ä–æ–Ω–∞ –ú–∞–∫-–ö–∞–ª–ª–æ–∫–∞-–ü–∏—Ç—Ç—Å–∞ —Å–æ–∑–¥–∞–ª –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –∞ –∑–∞—Ç–µ–º –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ ‚Äî <strong>–ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω</strong>. –° —ç—Ç–æ–≥–æ –∏ –Ω–∞—á–∞–ª–∞—Å—å –∏—Å—Ç–æ—Ä–∏—è –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π. –¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫—É—é –º–æ–¥–µ–ª—å –Ω–µ–π—Ä–æ–Ω–∞, —Å –∫–æ—Ç–æ—Ä—ã–º –º—ã –±—É–¥–µ–º –∏–º–µ—Ç—å –¥–µ–ª–æ –¥–∞–ª—å—à–µ. –ù–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞—é—Ç—Å—è —á–∏—Å–ª–∞ (—Å–∏–≥–Ω–∞–ª—ã), –ø–æ—Å–ª–µ –æ–Ω–∏ —É–º–Ω–æ–∂–∞—é—Ç—Å—è –Ω–∞ –≤–µ—Å–∞ (–∫–∞–∂–¥—ã–π —Å–∏–≥–Ω–∞–ª ‚Äì –Ω–∞ —Å–≤–æ–π –≤–µ—Å) –∏ —Å—É–º–º–∏—Ä—É—é—Ç—Å—è. –ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω–æ–≥–¥–∞ –µ—â–µ –¥–æ–±–∞–≤–ª—è—é—Ç –∫–∞–∫—É—é-—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É —Å–º–µ—â–µ–Ω–∏—è (–¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –Ω–∞ —Ä–∏—Å—É–Ω–∫–µ —Å–º–µ—â–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç). –ó–∞—Ç–µ–º —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤—ã—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—ã—Ö–æ–¥–Ω–æ–π —Å–∏–≥–Ω–∞–ª –∏ –ø–æ–¥–∞–µ—Ç –µ–≥–æ –Ω–∞ –≤—ã—Ö–æ–¥.</p>
<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2021/03/28/neiroseti-dlia-mikrokontrollerov-pertseptron/perceptron.png" style="width:100%; display:block; border:1px solid #ddd;"></p>
<p>–ò–¥–µ—è —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ç–∞–∫–∂–µ –≤–∑—è—Ç–∞ –∏–∑ –±–∏–æ–ª–æ–≥–∏–∏. –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –∏–ª–∏ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Å–∏–≥–Ω–∞–ª–∞–º –æ—Ç –Ω–µ–π—Ä–æ–Ω–∞ –∫ –Ω–µ–π—Ä–æ–Ω–∞–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –æ–Ω–∏ –ø–µ—Ä–µ–¥–∞—é—Ç. –¢.–µ. –µ—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω–æ–π, —Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –µ–µ, –∞ –µ—Å–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –º–∞–ª–æ –∏–ª–∏ –æ–Ω–∞ –Ω–µ–¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–∞, —Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –µ–π –ø—Ä–æ–π—Ç–∏ –¥–∞–ª—å—à–µ.</p>
<p>–§—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –±—ã–≤–∞—é—Ç –æ—á–µ–Ω—å —Ä–∞–∑–Ω—ã–µ, –≤—ã–±–æ—Ä –æ–±—É—Å–ª–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –æ–±–ª–∞—Å—Ç—å—é –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ò–ù–° –∏ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω–æ–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∑–∞–¥–∞—á–µ–π –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –ø–æ –º–∞—à–∏–Ω–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é. –í–æ—Ç —Ç–∞–∫ –Ω–∞–ø—Ä–∏–º–µ—Ä –≤—ã–≥–ª—è–¥—è—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö:</p>
<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2021/03/28/neiroseti-dlia-mikrokontrollerov-pertseptron/activation.png" style="width:100%; display:block; border:1px solid #ddd;"></p>
<p>–û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –≤ —Å–∞–º–æ–º –ø—Ä–æ—Å—Ç–æ–º —Å–ª—É—á–∞–µ –≤—Å—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –æ–¥–Ω–∏–º –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –Ω–µ–π—Ä–æ–Ω–æ–º. –ü—Ä–∏ —ç—Ç–æ–º –¥–∞–∂–µ –æ–¥–∏–Ω –Ω–µ–π—Ä–æ–Ω —Ö–æ—Ä–æ—à–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∑–∞–¥–∞—á–µ–π  —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞ –æ–±—ä–µ–∫—Ç–∞ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–±—ä–µ–∫—Ç—ã —ç—Ç–∏—Ö –∫–ª–∞—Å—Å–æ–≤ —è–≤–ª—è—é—Ç—Å—è –ª–∏–Ω–µ–π–Ω–æ —Å–µ–ø–∞—Ä–∞–±–µ–ª—å–Ω—ã–º–∏. –ü—Ä–æ—Å—Ç—ã–º –ø—Ä–∏–º–µ—Ä–æ–º –ª–∏–Ω–µ–π–Ω–æ–π —Å–µ–ø–∞—Ä–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ —è–≤–ª—è—é—Ç—Å—è –±—É–ª–µ–≤—ã —Ñ—É–Ω–∫—Ü–∏–∏ OR –∏ AND, –¥–ª—è —Ç–∞–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –ø—Ä—è–º—É—é (–∏–ª–∏ –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å –≤ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ), –æ—Ç–¥–µ–ª—è—é—â—É—é 0 –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç 1. –ê –≤–æ—Ç —Å —Ñ—É–Ω–∫—Ü–∏–µ–π XOR –¥–µ–ª–∞ –æ–±—Å—Ç–æ—è—Ç –Ω–µ–º–Ω–æ–≥–æ —Å–ª–æ–∂–Ω–µ–µ –∏ —Å–µ—Ç—å –∏–∑ –æ–¥–Ω–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ —Å —Ç–∞–∫–æ–π –∑–∞–¥–∞—á–µ–π —É–≤—ã –Ω–µ —Å–ø—Ä–∞–≤–∏—Ç—Å—è.</p>
<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2021/03/28/neiroseti-dlia-mikrokontrollerov-pertseptron/or_xor.png" style="width:100%; display:block; border:1px solid #ddd;"></p>
<p>–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –æ–¥–Ω—É –ø—Ä—è–º—É—é —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã —Ä–∞–∑–¥–µ–ª–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏—Å–∫–ª—é—á–∞—é—â–µ–≥–æ –ò–õ–ò. –ö —Å—á–∞—Å—Ç—å—é, —Ä–µ—à–µ–Ω–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ–µ. –î–ª—è —ç—Ç–æ–≥–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π, —Å–æ—Å—Ç–æ—è—â–∏–µ –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ç–∞–∫–∏—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –≤ —Å–ª–æ–∏. –¢–∞–∫–∏–µ –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–µ —Å–µ—Ç–∏ –µ—â–µ –Ω–∞–∑—ã–≤–∞—é—Ç –≥–ª—É–±–æ–∫–∏–º–∏. –ò–º –ø–æ–¥ —Å–∏–ª—É —Ä–µ—à–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –Ω–µ –º–æ–∂–µ—Ç —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è –ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –ª–∏–Ω–µ–π–Ω–æ –Ω–µ—Ä–∞–∑–¥–µ–ª–∏–º—ã–µ –∑–∞–¥–∞—á–∏. –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ <strong>–º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–π –ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω</strong> —Å –æ–¥–Ω–∏–º —Å–∫—Ä—ã—Ç—ã–º —Å–ª–æ–µ–º –≤—ã–≥–ª—è–¥–∏—Ç –≤–æ—Ç —Ç–∞–∫:</p>
<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2021/03/28/neiroseti-dlia-mikrokontrollerov-pertseptron/dog_cat.gif" style="width:100%; display:block; border:1px solid #ddd;"></p>
<p>–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –ø—Ä–∞–∫—Ç–∏–∫–µ –ø–∞—Ä—É —Å–ª–æ–≤ –æ —Ç–æ–º –∫–∞–∫ –æ–±—É—á–∏—Ç—å –Ω–µ–π—Ä–æ—Å–µ—Ç—å. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–¥–æ–±—Ä–∞—Ç—å –≤–µ—Å–∞ –¥–ª—è –Ω–µ–π—Ä–æ–Ω–æ–≤ —Ç–∞–∫, —á—Ç–æ–±—ã –æ—à–∏–±–∫–∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ –±—ã–ª–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π ? –û–±—ã—á–Ω–æ –≤–µ—Å–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º. –í –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –≤–µ—Å–æ–≤ –º–µ–Ω—è—é—Ç—Å—è. –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —Å–µ–π—á–∞—Å –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –ø—Ä–∏–º–µ–Ω—è—é—Ç –º–µ—Ç–æ–¥ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ –∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ—à–∏–±–∫–∏. –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –±–∏–±–ª–∏–æ—Ç–µ–∫ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω–∞–ø—Ä–∏–º–µ—Ä Tensorflow, Pytorch –∏ –¥—Ä. –¥–∞—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å –ª–µ–≥–∫–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ —ç—Ç–∏–º –º–µ—Ç–æ–¥–æ–º, –Ω–µ –≤–¥–∞–≤–∞—è—Å—å –≤ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –µ–≥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫ ‚Äî –º–µ—Ç–æ–¥ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –æ—à–∏–±–∫–∏ (—Å—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–∏–¥–æ–≤ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏). –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ª—é–±–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –æ–∑–Ω–∞—á–∞–µ—Ç –ø–æ–∏—Å–∫ —Å–∞–º–æ–π –≥–ª—É–±–æ–∫–æ–π –≤–ø–∞–¥–∏–Ω—ã –≤ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.</p>
<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2021/03/28/neiroseti-dlia-mikrokontrollerov-pertseptron/gradient.gif" style="width:100%; display:block; border:1px solid #ddd; padding: 10px 0;"></p>
<p>–ò—Ç–∞–∫ —É –Ω–∞—Å –µ—Å—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –≤–µ—Å–æ–≤, –º—ã —Ö–æ—Ç–∏–º –≤–Ω–µ—Å—Ç–∏ –≤ –Ω–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞—é—Ç –Ω–∞—à—É –º–æ–¥–µ–ª—å –ª—É—á—à–µ, —É–º–µ–Ω—å—à–∞—é—Ç –æ—à–∏–±–∫—É. –ï—â–µ —É –Ω–∞—Å –µ—Å—Ç—å –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∏ —Ç–æ–≥–æ —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∞—Ç—å –Ω–∞ –≤—ã—Ö–æ–¥–µ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏. –¢–∞–∫–∂–µ –µ—Å—Ç—å –Ω–µ–∫–∞—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —á–∏—Å–ª–µ–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –æ—à–∏–±–∫–∏ –Ω–∞ –≤—ã—Ö–æ–¥–µ. –ï—Å–ª–∏ –±—É–¥–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤–ª–∏—è—é—Ç –≤–µ—Å–∞ –Ω–∞ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é, —Ç–æ –±—É–¥–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –∏—Ö –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å. –¢—É—Ç –Ω–∞–º –ø–æ–º–æ–∂–µ—Ç —á–∞—Å—Ç–Ω–∞—è <a href="https://mazko.github.io/blog/posts/2016/11/30/ngspicejs-analogovye-integrator-i-differentsiator/">–ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–∏</a> –æ—à–∏–±–∫–∏ ‚Äî –≥—Ä–∞–¥–∏–µ–Ω—Ç. –ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫—Ä—É—Ç–∏–∑–Ω—É –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –∑–∞–¥–∞–Ω–Ω–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–µ. –ï—Å–ª–∏ —á–∞—Å—Ç–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –∏–∑–≤–µ—Å—Ç–Ω–∞, –º–æ–∂–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∞—Ç—å –∫ –æ–±—É—á–µ–Ω–∏—é —Å–µ—Ç–∏, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —à–∞–≥–æ–≤:</p>
<ul>
<li>
<p>–ø—Ä—è–º–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ ‚Äî –æ–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–∞—é—Ç—Å—è –Ω–∞ –≤—Ö–æ–¥ —Å–µ—Ç–∏, –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –≤—Å–µ –≤–µ—Å–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å –∂–µ–ª–∞–µ–º—ã–º–∏ —Ü–µ–ª–µ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏–º–∏ –∏ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–µ–∫—É—â–∞—è –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏</p>
</li>
<li>
<p>–æ–±—Ä–∞—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ ‚Äî –∑–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω—É –æ—à–∏–±–∫–∏ —Å–µ—Ç–∏ –∏ —á–∞—Å—Ç–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è  –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ –∫–∞–∂–¥–æ–º—É –≤–µ—Å—É, –≤–µ—Å–∞ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è —Å —É—á–µ—Ç–æ–º –Ω–µ–∫–æ–µ–≥–æ –Ω–µ–±–æ–ª—å—à–æ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –Ω–∞—á–∏–Ω–∞—è —Å –≤–µ—Å–æ–≤ –≤—ã—Ö–æ–¥–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤</p>
</li>
</ul>
<p>–ü–æ–≤—Ç–æ—Ä—è—Ç—å —ç—Ç–∏ —à–∞–≥–∏ –Ω—É–∂–Ω–æ –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ, –¥–æ —Ç–µ—Ö –ø–æ—Ä –ø–æ–∫–∞ –æ—à–∏–±–∫–∞ –Ω–µ –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç —É–º–µ–Ω—å—à–∞—Ç—å—Å—è. –î–≤–∏–≥–∞—è—Å—å –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –º—ã –±—É–¥–µ–º –ø–ª–∞–≤–Ω–æ —Å–∫–∞—Ç—ã–≤–∞—Ç—å—Å—è –≤ –Ω–∏–∑–∏–Ω—É, –∞ –¥–∏–Ω–∞–º–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç —à–∞—Ä–∏–∫, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Å–∫–∞—Ç—ã–≤–∞—é—â–∏–π—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º.</p>
<h2>–ü–†–ê–ö–¢–ò–ö–ê</h2>
<p>–¢—É—Ç –º—ã –æ–±—É—á–∏–º –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–π –ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏—é XOR. –û–±—É—á–∞—Ç—å –±—É–¥–µ–º –≤ Tensorflow (–Ω–µ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±—É—é –¥—Ä—É–≥—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è). –û–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å —Ä–∞–∑–≤–µ—Ä–Ω–µ–º –Ω–∞ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ —Å <a href="https://mazko.github.io/blog/posts/2017/03/20/s-18-dlia-mikrokontrollerov-razvedka-boem/">C++</a> –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º.</p>
<p><a href="http://mazko.github.io/MSP430.js/4f2e6920a7b5c509b539485319ae0fdb">MSP430.js</a> | <a href="https://mazko.github.io/blog/posts/2021/03/28/neiroseti-dlia-mikrokontrollerov-pertseptron/xor.html">–Ω–æ—É—Ç–±—É–∫</a> | <a href="https://mazko.github.io/blog/posts/2021/03/28/neiroseti-dlia-mikrokontrollerov-pertseptron/uxor.zip">–∏—Å—Ö–æ–¥–Ω–∏–∫–∏</a></p>
<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2021/03/28/neiroseti-dlia-mikrokontrollerov-pertseptron/ui.gif" style="width:55%; margin: 0 auto; display:block;"></p>
<p>–ß—Ç–æ–±—ã –æ–±—É—á–∏—Ç—å –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å, –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –∏—Å—Ö–æ–¥–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–∏–Ω–Ω–æ—Å—Ç–∏ –∏—Å–∫–ª—é—á–∞—é—â–µ–≥–æ –∏–ª–∏:</p>
<div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>


<p>–¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏. –ü—É—Å—Ç—å —ç—Ç–æ –±—É–¥–µ—Ç –ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω —Å –æ–¥–Ω–∏–º —Å–∫—Ä—ã—Ç—ã–º —Å–ª–æ–µ–º –∏–∑ —Ç—Ä–µ—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤. –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è Relu. –í—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –æ–¥–Ω–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ Sigmoid. –î–≤–∞ –≤—Ö–æ–¥–∞:</p>
<div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">x_in</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
                       <span class="n">kernel_regularizer</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span>
                       <span class="n">bias_regularizer</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">x_in</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</pre></div>


<p>–¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à—É –º–æ–¥–µ–ª—å, —Ç–æ –µ—Å—Ç—å, –ø–æ —Å—É—â–µ—Å—Ç–≤—É, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è. –ë—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä Adam. –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä ‚Äî —ç—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–º–µ–Ω—è–µ—Ç –≤–µ—Å–∞ –∏ —Å–º–µ—â–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è. –í –∫–∞—á–µ—Å—Ç–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—à–∏–±–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É MSE(mean squared error). –í –Ω–µ–π—Ä–æ–Ω–Ω—ã–π —Å–µ—Ç—è—Ö —Ñ—É–Ω–∫—Ü–∏—é –æ—à–∏–±–∫–∏ —á–∞—Å—Ç–æ –Ω–∞–∑—ã–≤–∞—é—Ç —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–æ—Ç–µ—Ä—å:</p>
<div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">)</span>
</pre></div>


<p>–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å –Ω–∞—à—É –º–æ–¥–µ–ª—å. –û–±—É—á–µ–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ—Ç –∫–∞–∫–æ–µ-—Ç–æ –≤—Ä–µ–º—è, –∫–æ—Ç–æ—Ä–æ–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å–µ—Ç–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —Å–µ—Ç—å –∫—Ä–æ—à–µ—á–Ω–∞—è, –º–æ–∂–Ω–æ –æ–±—É—á–∞—Ç—å –Ω–∞ –ª—é–±–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ. –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ —Å–µ—Ç–∏ —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–µ–π –æ–±—É—á–∞—Ç—å –Ω–∞ —Ö–æ—Ä–æ—à–∏—Ö –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞—Ö. –ú–µ—Ç–æ–¥ fit –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö. –≠–ø–æ—Ö–∞ ‚Äî —ç—Ç–æ –æ–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–∞—Ç–∞—Å–µ—Ç–∞. –° –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–æ–π –æ–±—É—á–µ–Ω–∏—è –æ—à–∏–±–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø–∞–¥–∞—Ç—å –≤–ø–ª–æ—Ç—å –¥–æ –∫–∞–∫–æ–≥–æ-—Ç–æ —Ä–∞–∑—É–º–Ω–æ–≥–æ –ø—Ä–µ–¥–µ–ª–∞.</p>
<div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>


<p>–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è —Å–µ—Ç—å—é —É–∂–µ –º–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è. –¢–∞–∫ –∫–∞–∫ –ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ –µ—ë –≤–µ—Å–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –Ω–æ–≤–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –±—É–¥—É—Ç –Ω–µ–º–Ω–æ–≥–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã—Ö –Ω–∏–∂–µ:</p>
<div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>


<p>–†–µ–∑—É–ª—å—Ç–∞—Ç:</p>
<div class="highlight"><pre><span></span>array(
  [[0.01152042],
   [0.98572624],
   [0.99311346],
   [0.00970006]], dtype=float32)
</pre></div>


<p>–¢–µ–ø–µ—Ä—å –Ω–µ–º–Ω–æ–∂–∫–æ –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä—ã. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ –Ω–µ–ø–ª–æ—Ö–æ –±—ã –≤—Å–ø–æ–º–Ω–∏—Ç—å —á—Ç–æ —Ç–∞–º –Ω–∞–º –≤ –∏–Ω—Å—Ç–∏—Ç—É—Ç–µ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–ª–∏ –ø—Ä–æ –º–∞—Ç—Ä–∏—Ü—ã. –î–ª—è –Ω–∞—á–∞–ª–∞ –≤—ã–≤–µ–¥–µ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –≤–µ—Å–æ–≤ –Ω–∞ —ç–∫—Ä–∞–Ω.</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">get_weights</span><span class="p">():</span>
    <span class="n">arr2str</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%0.9g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;W{} = {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">arr2str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">w</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;B{} = {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">arr2str</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>
</pre></div>


<p>–†–µ–∑—É–ª—å—Ç–∞—Ç:</p>
<div class="highlight"><pre><span></span>W1 = [[-0.100219101, 0.0986418799, 0.0540673025], [-0.101571321, 0.055912815, -0.0540193357]]
B1 = [0.101785883, -0.0555998087, -7.84907461e-05]
W2 = [[-85.8035507], [-90.0149384], [87.0291138]]
B2 = [4.28154087]
</pre></div>


<p>–£ –Ω–∞—Å –¥–≤–∞ —Å–ª–æ—è —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –≤–µ—Å–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ –Ω–∏—Ö –ø–ª—é—Å —Å–º–µ—â–µ–Ω–∏–µ. –ß—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω–∏–º–∞—Ç—å –º–∞—Ç–µ–º–∞—Ç–∏–∫—É –≤–Ω—É—Ç—Ä–∏ –ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω–∞ –¥–∞–≤–∞–π—Ç–µ –æ—Ç–≤—è–∂–µ–º—Å—è –æ—Ç Tensorflow –∏ –≤—ã—á–∏—Å–ª–∏–º –≤—Å–µ —Ç–æ –∂–µ —Å–∞–º–æ–µ –∏—Å—Ö–æ–¥—è –∏–∑ —É–∂–µ –∏–º–µ—é—â–∏—Ö—Å—è —É –Ω–∞—Å –≤–µ—Å–æ–≤:</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
  <span class="c1"># First layer calculation</span>
  <span class="n">L1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">W1</span><span class="p">)</span> <span class="o">+</span> <span class="n">B1</span>
  <span class="c1"># Relu activation function</span>
  <span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">L1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
  <span class="c1"># Second layer calculation</span>
  <span class="n">L2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">W2</span><span class="p">)</span> <span class="o">+</span> <span class="n">B2</span>
  <span class="c1"># Sigmoid</span>
  <span class="n">output</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L2</span><span class="p">))</span>
  <span class="k">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>


<p>–†–µ–∑—É–ª—å—Ç–∞—Ç:</p>
<div class="highlight"><pre><span></span><span class="k">[0.01152039]</span>
<span class="k">[0.98572624]</span>
<span class="k">[0.99311345]</span>
<span class="k">[0.00970005]</span>
</pre></div>


<p>–ö–∞–∫ –≤–∏–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–ª —Å —Ç–µ–º, —á—Ç–æ –≤—ã–¥–∞–µ—Ç –º–µ—Ç–æ–¥ predict –≤ –Ω–∞—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –Ω–∞–º–∏ —Å–µ—Ç–∏. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ —Å–ª–æ—è –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —É–º–Ω–æ–∂–µ–Ω–∏–∏ –≤—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≤–µ—Å–æ–≤—É—é –º–∞—Ç—Ä–∏—Ü—É, –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –ø—Ä–∏–±–∞–≤–ª—è–µ—Ç—Å—è —Å–º–µ—â–µ–Ω–∏–µ. –ó–∞—Ç–µ–º –∏–¥–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è. –†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –≤–µ–∫—Ç–æ—Ä —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ –≤—Ç–æ—Ä—É—é –≤–µ—Å–æ–≤—É—é –º–∞—Ç—Ä–∏—Ü—É –∏ —Ç.–¥.</p>
<p>–î—É–º–∞—é –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ —è—Å–Ω–∞ :) –¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä–Ω–µ–º —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ –¥–ª—è –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞:</p>
<p><em>nn.h</em></p>
<div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;array&gt;</span><span class="cp"></span>

<span class="k">namespace</span> <span class="n">nn</span> <span class="p">{</span>

  <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">N</span><span class="o">&gt;</span>
  <span class="k">using</span> <span class="n">o</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">N</span><span class="o">&gt;</span>
  <span class="k">using</span> <span class="n">i</span> <span class="o">=</span> <span class="k">const</span> <span class="n">o</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">N</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">K</span><span class="o">&gt;</span>
  <span class="k">using</span> <span class="n">m</span> <span class="o">=</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">K</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">N</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">N</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">K</span><span class="o">&gt;</span>
  <span class="kt">void</span> <span class="n">dot</span><span class="p">(</span><span class="n">m</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">,</span> <span class="n">o</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">K</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">o</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">K</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span><span class="p">)</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">o</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">r</span><span class="o">++</span><span class="p">)</span>
        <span class="n">o</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+=</span> <span class="n">x</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">r</span><span class="p">).</span><span class="n">at</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">N</span><span class="o">&gt;</span>
  <span class="kt">void</span> <span class="n">relu</span><span class="p">(</span><span class="n">o</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">x</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">const</span> <span class="n">T</span> <span class="n">zero</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
      <span class="n">x</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">zero</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">N</span><span class="o">&gt;</span>
  <span class="kt">void</span> <span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">,</span> <span class="n">o</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">x</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
      <span class="n">x</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">N</span><span class="o">&gt;</span>
  <span class="kt">void</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">o</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">x</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">const</span> <span class="n">T</span> <span class="n">one</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
      <span class="n">x</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">one</span> <span class="o">/</span> <span class="p">(</span><span class="n">one</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)));</span>
  <span class="p">}</span>

<span class="p">}</span> <span class="c1">// namespace</span>
</pre></div>


<p><em>app.cpp</em></p>
<div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;float32.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;nn.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;draw.h&quot;</span><span class="cp"></span>

<span class="k">using</span> <span class="n">flt</span> <span class="o">=</span> <span class="n">float32</span><span class="p">;</span>

<span class="k">static</span> <span class="kt">float</span> <span class="nf">inference</span><span class="p">(</span><span class="k">const</span> <span class="n">flt</span><span class="o">&amp;</span> <span class="n">x1</span><span class="p">,</span> <span class="k">const</span> <span class="n">flt</span><span class="o">&amp;</span> <span class="n">x2</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">const</span> <span class="n">nn</span><span class="o">::</span><span class="n">m</span><span class="o">&lt;</span><span class="n">flt</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">&gt;</span> <span class="n">W1</span>
  <span class="p">{</span>
    <span class="o">-</span><span class="mf">0.100219101</span><span class="p">,</span> <span class="mf">0.0986418799</span><span class="p">,</span> <span class="mf">0.0540673025</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">0.101571321</span><span class="p">,</span> <span class="mf">0.055912815</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0540193357</span>
  <span class="p">};</span>
  <span class="k">const</span> <span class="n">nn</span><span class="o">::</span><span class="n">i</span><span class="o">&lt;</span><span class="n">flt</span><span class="p">,</span> <span class="mi">3</span><span class="o">&gt;</span> <span class="n">B1</span>
  <span class="p">{</span>
    <span class="mf">0.101785883</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0555998087</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.84907461e-05</span>
  <span class="p">};</span>
  <span class="k">const</span> <span class="n">nn</span><span class="o">::</span><span class="n">m</span><span class="o">&lt;</span><span class="n">flt</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="n">W2</span>
  <span class="p">{</span>
    <span class="o">-</span><span class="mf">85.8035507</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.0149384</span><span class="p">,</span> <span class="mf">87.0291138</span>
  <span class="p">};</span>
  <span class="k">const</span> <span class="n">nn</span><span class="o">::</span><span class="n">i</span><span class="o">&lt;</span><span class="n">flt</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="n">B2</span>
  <span class="p">{</span>
    <span class="mf">4.28154087</span>
  <span class="p">};</span>

  <span class="c1">// Inputs</span>
  <span class="n">nn</span><span class="o">::</span><span class="n">i</span><span class="o">&lt;</span><span class="n">flt</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">{</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">};</span>

  <span class="c1">// First layer has 3 units</span>
  <span class="n">nn</span><span class="o">::</span><span class="n">o</span><span class="o">&lt;</span><span class="n">flt</span><span class="p">,</span> <span class="mi">3</span><span class="o">&gt;</span> <span class="n">L1</span><span class="p">;</span>
  <span class="n">nn</span><span class="o">::</span><span class="n">dot</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">L1</span><span class="p">);</span>
  <span class="n">nn</span><span class="o">::</span><span class="n">add</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span> <span class="n">L1</span><span class="p">);</span>
  <span class="n">nn</span><span class="o">::</span><span class="n">relu</span><span class="p">(</span><span class="n">L1</span><span class="p">);</span>

  <span class="c1">// Second layer has 1 unit</span>
  <span class="n">nn</span><span class="o">::</span><span class="n">o</span><span class="o">&lt;</span><span class="n">flt</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="n">L2</span><span class="p">;</span>
  <span class="n">nn</span><span class="o">::</span><span class="n">dot</span><span class="p">(</span><span class="n">W2</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="p">);</span>
  <span class="n">nn</span><span class="o">::</span><span class="n">add</span><span class="p">(</span><span class="n">B2</span><span class="p">,</span> <span class="n">L2</span><span class="p">);</span>
  <span class="n">nn</span><span class="o">::</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">L2</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">L2</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">namespace</span> <span class="n">app</span> <span class="p">{</span>

  <span class="kt">int</span> <span class="n">run</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">draw</span><span class="o">::</span><span class="n">flt</span><span class="p">(</span><span class="n">draw</span><span class="o">::</span><span class="n">PAGE_0</span><span class="p">,</span> <span class="n">inference</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
    <span class="n">draw</span><span class="o">::</span><span class="n">flt</span><span class="p">(</span><span class="n">draw</span><span class="o">::</span><span class="n">PAGE_2</span><span class="p">,</span> <span class="n">inference</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
    <span class="n">draw</span><span class="o">::</span><span class="n">flt</span><span class="p">(</span><span class="n">draw</span><span class="o">::</span><span class="n">PAGE_4</span><span class="p">,</span> <span class="n">inference</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
    <span class="n">draw</span><span class="o">::</span><span class="n">flt</span><span class="p">(</span><span class="n">draw</span><span class="o">::</span><span class="n">PAGE_6</span><span class="p">,</span> <span class="n">inference</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –±–æ–ª—å—à–∏—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –º–æ—â–Ω–æ—Å—Ç–µ–π. –ó–¥–µ—Å—å –Ω–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥—è—Ç –≥–æ—Ç–æ–≤—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Ç–∞–∫–∏–µ –∫–∞–∫ Tensorflow. –° –∏—Ö –ø–æ–º–æ—â—å—é –º–æ–∂–Ω–æ –æ–±—É—á–∞—Ç—å –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –Ω–∞ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞—Ö, –≤ –æ–±–ª–∞–∫–µ, –∏ –¥–∞–∂–µ –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö, —Å–æ—Å—Ç–æ—è—â–∏—Ö –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –º–æ–∂–Ω–æ –Ω–∞ –≥–¥–µ-—É–≥–æ–¥–Ω–æ, –¥–∞–∂–µ –Ω–∞ –æ—á–µ–Ω—å —Å–ª–∞–±—ã—Ö –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö.</p>
    </div><!-- /.entry-content -->
  </article>
</section>


<div class="body" id="proiot-comments">
  <div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'mazko';
      var disqus_identifier = 'blog/posts/2021/03/28/neiroseti-dlia-mikrokontrollerov-pertseptron/';
      var disqus_url = 'https://mazko.github.io/blog/posts/2021/03/28/neiroseti-dlia-mikrokontrollerov-pertseptron/';
      (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//mazko.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the comments.</noscript>
  </div>
</div>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a rel="nofollow" href="http://getpelican.com/">Pelican</a></li>
                            <li><a rel="nofollow" href="http://python.org/">Python.org</a></li>
                            <li><a rel="nofollow" href="http://jinja.pocoo.org/">Jinja2</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://mazko.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a rel="nofollow" href="http://github.com/mazko">github</a></li>
                            <li><a rel="nofollow" href="http://linkedin.com/in/mazko">linkedin</a></li>
                            <li><a rel="nofollow" href="http://stackoverflow.com/users/281102/oleg-mazko">stackoverflow</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'mazko';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>