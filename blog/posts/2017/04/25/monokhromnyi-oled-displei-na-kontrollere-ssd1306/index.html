<!DOCTYPE html>
<html lang="ru">
<head>
        <meta charset="utf-8" />
        <title>–ú–æ–Ω–æ—Ö—Ä–æ–º–Ω—ã–π OLED –¥–∏—Å–ø–ª–µ–π –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ SSD1306</title>
        <link rel="stylesheet" href="https://mazko.github.io/blog/theme/css/main.css" />
        <link href="https://mazko.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="üè† –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –í—Å–µ–≥–æ üöó Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://mazko.github.io/">üè† –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –í—Å–µ–≥–æ üöó </a></h1>
                <nav><ul>
                    <li><a href="https://mazko.github.io/blog/category/admin/">Admin</a></li>
                    <li><a href="https://mazko.github.io/blog/category/electronics/">Electronics</a></li>
                    <li class="active"><a href="https://mazko.github.io/blog/category/embedded/">Embedded</a></li>
                    <li><a href="https://mazko.github.io/blog/category/iot/">IoT</a></li>
                    <li><a href="https://mazko.github.io/blog/category/java/">Java</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://mazko.github.io/blog/posts/2017/04/25/monokhromnyi-oled-displei-na-kontrollere-ssd1306/" rel="bookmark"
           title="Permalink to –ú–æ–Ω–æ—Ö—Ä–æ–º–Ω—ã–π OLED –¥–∏—Å–ø–ª–µ–π –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ SSD1306">–ú–æ–Ω–æ—Ö—Ä–æ–º–Ω—ã–π OLED –¥–∏—Å–ø–ª–µ–π –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ SSD1306</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-04-25T00:00:00+03:00">
                –í—Ç 25 –∞–ø—Ä–µ–ª—è 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://mazko.github.io/blog/author/oleg-mazko/">Oleg Mazko</a>
        </address>
<p>In <a href="https://mazko.github.io/blog/category/embedded/">Embedded</a>.</p>
<p>tags: <a href="https://mazko.github.io/blog/tag/msp430">msp430</a> <a href="https://mazko.github.io/blog/tag/ssd1306">SSD1306</a> </p>
</footer><!-- /.post-info -->      <p>–î–∞–Ω–Ω—ã–π –¥–≤—É—Ö—Ü–≤–µ—Ç–Ω—ã–π (—á—ë—Ä–Ω–æ-–±–µ–ª—ã–π) —ç–∫—Ä–∞–Ω—á–∏–∫ –∏–º–µ–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ 128—Ö64 –ø–∏–∫—Å–µ–ª–∞ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä SSD1306 —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ª–∏–±–æ –ø–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º—É 8-–±–∏—Ç–Ω–æ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É 6800/8080 –ª–∏–±–æ –ø–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º—É I2C/SPI. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ —Ü–µ–ª–æ–º –ø–æ—Ö–æ–∂ –Ω–∞ <a href="https://mazko.github.io/blog/posts/2017/01/27/picsimjs-simvolnyi-displei-na-baze-hd44780/">HD44780</a> - –¥–ª—è –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ (–∑–∞–ø–∏—Å–∏) –≤—ã—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ 8 –±–∏—Ç, –µ—â—ë –æ–¥–∏–Ω –±–∏—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É/–¥–∞–Ω–Ω—ã–µ, –∏ –æ–¥–∏–Ω –±–∏—Ç –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ–π –ø–∞—Ä–æ—á–∫–∏ –∏—Ç–æ–≥–æ –º–∏–Ω–∏–º—É–º 10 –Ω–æ–≥ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–±–æ–π—Ç–∏—Å—å –º–µ–Ω—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –Ω–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç—É–ø–∞—é—Ç –≤ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏. –£ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ msp430f1611 –ø—Ä–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—ã–≤–æ–¥–æ–≤ –∏ –≤ –¥–∞–Ω–Ω–æ–º –æ–±—É—á–∞—é—â–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–µ—Ä–∏—Ñ–µ—Ä–∏—é I2C/SPI, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è—Ö SSD1306. –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ - <code>ssd1306_write_data</code> –∏ <code>ssd1306_write_instruction</code>.</p>
<p><a href="http://mazko.github.io/MSP430.js/4a1dee2b02e6d149594b10d03b7925c8">MSP430.js</a> | <a href="https://mazko.github.io/blog/posts/2017/04/25/monokhromnyi-oled-displei-na-kontrollere-ssd1306/img.zip">–∏—Å—Ö–æ–¥–Ω–∏–∫–∏</a></p>
<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2017/04/25/monokhromnyi-oled-displei-na-kontrollere-ssd1306/ui.gif" style="width:55%; margin: 0 auto; display:block;"></p>
<p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSD1306 –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è –¥–≤—É–º—è —Ñ—É–Ω–∫—Ü–∏—è–º–∏ - –∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–ø–∏—Å—å –∫–æ–º–∞–Ω–¥. –ö–∞—Ä—Ç–∞ –ø–∞–º—è—Ç–∏ GDDRAM –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ 8-—é —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ –ø–æ 128 –±–∞–π—Ç. –°–∏—Å—Ç–µ–º–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏–º–µ–µ—Ç –Ω–∞—á–∞–ª–æ –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É. –î–ª—è –∑–∞–ø–∏—Å–∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–≥–æ –±–∞–π—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –∞–¥—Ä–µ—Å—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è <code>ssd1306_write_byte</code>. –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ SSD1306 –Ω–µ –¥–∞—ë—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–æ—á–∫—É –Ω–∞ –¥–∏—Å–ø–ª–µ–µ, —Ç–æ–ª—å–∫–æ –±–∞–π—Ç. –ï—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ—Ä–∏—Å–æ–≤—ã–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏ –≤–º–µ—Å—Ç–æ –±–∞–π—Ç –Ω—É–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å –≤—Å–µ –ø–∏–∫—Å–µ–ª–∏ –≤ –ø–∞–º—è—Ç–∏ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ (–±—É—Ñ–µ—Ä 128x8) –∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Å–∫–∏–¥—ã–≤–∞—Ç—å –∏—Ö –Ω–∞ –¥–∏—Å–ø–ª–µ–π –ø–æ–±–∞–π—Ç–æ–≤–æ. –ü—Ä–∏ –∑–∞–ø–∏—Å–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–∞–π—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–¥–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å —Ç.–∫. –∫–∞–∂–¥–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ GDDRAM –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º—É –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç—É –∞–¥—Ä–µ—Å–∞ —Å—Ç–æ–ª–±—Ü–∞, –ø–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –∫–æ–Ω–µ—á–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è (128) —Å—á—ë—Ç—á–∏–∫ –∞–¥—Ä–µ—Å–∞ —Å—Ç–æ–ª–±—Ü–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (0), –∞ —Å—á—ë—Ç—á–∏–∫ –∞–¥—Ä–µ—Å–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É. –ü–æ—Å–ª–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å—á—ë—Ç—á–∏–∫–æ–º –∞–¥—Ä–µ—Å–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–æ–Ω–µ—á–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è (8) –æ–±–∞ —Å—á—ë—Ç—á–∏–∫–∞ —Å–±—Ä–æ—Å—è—Ç—Å—è –≤ –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–π–¥—ë—Ç –ø–æ –≤—Ç–æ—Ä–æ–º—É –∫—Ä—É–≥—É.</p>
<p><em>ssd1306.c</em></p>
<div class="highlight"><pre><span></span><span class="c1">// Address setting commands</span>
<span class="cp">#define SSD1306_SET_COL_LO_NIBBLE    0x00</span>
<span class="cp">#define SSD1306_SET_COL_HI_NIBBLE    0x10</span>
<span class="cp">#define SSD1306_SET_PAGE_START_ADDR  0xB0</span>

<span class="c1">// pins</span>
<span class="cp">#define SSD1306_DATA_INST            0</span>
<span class="cp">#define SSD1306_DATA_E               1</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">strobe</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">P3OUT</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">SSD1306_DATA_E</span><span class="p">);</span>
  <span class="n">P3OUT</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">SSD1306_DATA_E</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span>
<span class="nf">ssd1306_write_data</span> <span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">byte</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">P2OUT</span> <span class="o">=</span> <span class="n">byte</span><span class="p">;</span>
  <span class="n">P3OUT</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">SSD1306_DATA_INST</span><span class="p">);</span>
  <span class="n">strobe</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span>
<span class="nf">ssd1306_write_instruction</span> <span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">byte</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">P2OUT</span> <span class="o">=</span> <span class="n">byte</span><span class="p">;</span>
  <span class="n">P3OUT</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">SSD1306_DATA_INST</span><span class="p">);</span>
  <span class="n">strobe</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span>
<span class="nf">ssd1306_write_byte</span> <span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">x</span><span class="p">,</span> <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">page</span><span class="p">,</span> <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">byte</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">ssd1306_write_instruction</span> <span class="p">(</span><span class="n">SSD1306_SET_PAGE_START_ADDR</span> <span class="o">|</span> <span class="n">page</span><span class="p">);</span>
  <span class="n">ssd1306_write_instruction</span> <span class="p">(</span><span class="n">SSD1306_SET_COL_LO_NIBBLE</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">));</span>
  <span class="n">ssd1306_write_instruction</span> <span class="p">(</span><span class="n">SSD1306_SET_COL_HI_NIBBLE</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">));</span>
  <span class="n">ssd1306_write_data</span><span class="p">(</span><span class="n">byte</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>–õ—é–±–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ –∏–ª–∏ —Ç–µ–∫—Å—Ç —ç—Ç–æ –≤—Å–µ–≥–æ-–ª–∏—à—å –Ω–∞–±–æ—Ä –ø–∏–∫—Å–µ–ª–µ–π. –í —Å–ª—É—á–∞–µ SSD1306 —Ü–≤–µ—Ç–∞ –≤—Å–µ–≥–æ –¥–≤–∞ –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö —á—ë—Ä–Ω—ã–π. –î–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ª—é–±–æ–≥–æ —Ñ–∞–π–ª–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –°–∏ –º–∞—Å—Å–∏–≤ –ø–æ—Å–ª—É–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç –Ω–∞ –ø–∏—Ç–æ–Ω–µ + ImageMagick:</p>
<div class="highlight"><pre><span></span><span class="c1"># http://grep.js.org/?gist=96caa480d220062b18a693f1b2e9f275</span>
~$ <span class="nb">alias</span> <span class="nv">c128x64</span><span class="o">=</span><span class="s1">&#39;convert -resize 128x64!&#39;</span>
~$ c128x64 eyes.eps xbm:- <span class="p">|</span> grep -o <span class="s1">&#39;0[xX][0-9a-fA-F]\+&#39;</span> <span class="p">|</span> python3 -c <span class="s1">&#39;</span>

<span class="s1">import sys</span>

<span class="s1"># parse stdin image</span>
<span class="s1">xbm = [int(line, 16) for line in sys.stdin]</span>

<span class="s1"># convert</span>
<span class="s1">out = [[0]*128 for i in range(8)]</span>
<span class="s1">for y in range(64):</span>
<span class="s1">  for x in range(128):</span>
<span class="s1">    if x &amp; 7:</span>
<span class="s1">      byte &gt;&gt;= 1</span>
<span class="s1">    else:</span>
<span class="s1">      # 128 / 8 = 16 bytes in one xbm row</span>
<span class="s1">      byte = xbm[y * 16 + x // 8]</span>
<span class="s1">    if not byte &amp; 1:</span>
<span class="s1">      out[y // 8][x] |= (1 &lt;&lt; y % 8)</span>

<span class="s1"># print array</span>
<span class="s1">for p in out:</span>
<span class="s1">  print(&quot;{&quot; + &quot;,&quot;.join(hex(x) for x in p) + &quot;},&quot;)</span>
<span class="s1">&#39;</span>
</pre></div>


<p>–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Ç–æ–∂–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –Ω–∞–±–æ—Ä –≥–æ—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞. –ù–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π —Å–ª—É—á–∞–π - –º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π —à—Ä–∏—Ñ—Ç –≤—Å–µ –∑–Ω–∞–∫–∏ (–ø–ª–æ—â–∞–¥–∫–∏ –∑–Ω–∞–∫–æ–≤) –∫–æ—Ç–æ—Ä–æ–≥–æ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —à–∏—Ä–∏–Ω—É. –ù–∞–ø—Ä–∏–º–µ—Ä <a href="https://github.com/adafruit/Adafruit-GFX-Library/blob/master/glcdfont.c" rel="nofollow">—à—Ä–∏—Ñ—Ç</a> –¥–ª—è ASCII —Å–∏–º–≤–æ–ª–æ–≤ 5x7.</p>
<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2017/04/25/monokhromnyi-oled-displei-na-kontrollere-ssd1306/font.png" style="width:55%; margin: 0 auto; display:block;"></p>
<p><a href="http://mazko.github.io/MSP430.js/56a600e7efa1f648c5305d652d14be6a">MSP430.js</a> | <a href="https://mazko.github.io/blog/posts/2017/04/25/monokhromnyi-oled-displei-na-kontrollere-ssd1306/font.zip">–∏—Å—Ö–æ–¥–Ω–∏–∫–∏</a></p>
<div class="highlight"><pre><span></span><span class="cm">/*</span>

<span class="cm">reset &amp;&amp; (export GCC_DIR=~/ti/msp430_gcc ; </span>
<span class="cm">    $GCC_DIR/bin/msp430-elf-gcc \</span>
<span class="cm">    -I $GCC_DIR/include -L $GCC_DIR/include \</span>
<span class="cm">    -Werror -Wall -mmcu=msp430f1611 -O2 test.c ssd1306.c)</span>

<span class="cm">*/</span>

<span class="cp">#include</span> <span class="cpf">&lt;msp430.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&quot;ssd1306.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;font.c&quot;</span><span class="cp"></span>

<span class="cp">#define STATIC_ASSERT(cond) typedef int foo[(cond) ? 1 : -1]</span>
<span class="n">STATIC_ASSERT</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">font</span><span class="p">)</span> <span class="o">==</span> <span class="mi">256</span> <span class="o">*</span> <span class="mi">5</span> <span class="cm">/* uint8_t values 0..255 == 256 */</span><span class="p">);</span>
<span class="cp">#undef STATIC_ASSERT</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">drawchar</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">x</span><span class="p">,</span> <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">page</span><span class="p">,</span> <span class="k">const</span> <span class="kt">uint8_t</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">uint8_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">ssd1306_write_byte</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">font</span><span class="o">+</span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="n">i</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">drawstr</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">x</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">page</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">s</span> <span class="o">&amp;&amp;</span> <span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">drawchar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">page</span><span class="p">,</span> <span class="o">*</span><span class="n">s</span><span class="o">++</span><span class="p">);</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="mi">6</span><span class="p">;</span>     <span class="c1">// 6 pixels wide</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">&gt;=</span> <span class="n">SSD1306_X_PIXELS</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="c1">// ran out of this page</span>
      <span class="n">page</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">page</span> <span class="o">&gt;=</span> <span class="n">SSD1306_PIXEL_PAGES</span><span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>    <span class="c1">// ran out of space :(</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">WDTCTL</span> <span class="o">=</span> <span class="n">WDTPW</span> <span class="o">|</span> <span class="n">WDTHOLD</span><span class="p">;</span>     <span class="c1">// Stop watchdog timer</span>

    <span class="c1">// DCO = 3, RSEL = 0, f = 0.13 MHz</span>
    <span class="n">DCOCTL</span> <span class="o">=</span> <span class="cm">/* DCO2 + */</span> <span class="n">DCO1</span> <span class="o">+</span> <span class="n">DCO0</span><span class="p">;</span> 
    <span class="n">BCSCTL1</span> <span class="o">=</span> <span class="n">XT2OFF</span> <span class="cm">/* + RSEL1 + RSEL0 + RSEL2 */</span><span class="p">;</span>

    <span class="n">P2OUT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">P3OUT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">P2DIR</span> <span class="o">=</span> <span class="n">P3DIR</span> <span class="o">=</span> <span class="mh">0xFF</span><span class="p">;</span>

    <span class="n">ssd1306_init_display</span><span class="p">();</span>

    <span class="k">for</span><span class="p">(;;)</span> <span class="p">{</span>
      <span class="n">drawstr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;!</span><span class="se">\&quot;</span><span class="s">#$%&amp;&#39;()*+,-./0123456789:;&lt;=&gt;?@&quot;</span>
                    <span class="s">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ[</span><span class="se">\\</span><span class="s">]^_`&quot;</span>
                    <span class="s">&quot;abcdefghijklmnopqrstuvwxyz{|}~&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>–ó–¥–µ—Å—å <code>STATIC_ASSERT</code> —ç—Ç–æ <a href="https://mazko.github.io/blog/posts/2012/10/08/idiomy-v-ansi-c/">–∏–¥–∏–æ–º–∞</a> –°–∏, –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–∞ –≤ —Å–ª—É—á–∞–µ —Å–º–µ–Ω—ã —à—Ä–∏—Ñ—Ç–∞ - –Ω–∞ —Ç—É –∂–µ –∫–∏—Ä–∏–ª–ª–∏—Ü—É –Ω–∞–ø—Ä–∏–º–µ—Ä. –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω–µ—á–Ω–æ –ø—Ä–æ—Å—Ç–µ–π—à–∞—è, —Å–º–µ—â–µ–Ω–∏–µ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ –∑–∞–¥–∞—ë—Ç—Å—è –≤ –ø–∏–∫—Å–µ–ª—è—Ö, –Ω–æ –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ —Å–º–µ—â–µ–Ω–∏–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ - –º–∞–∫—Å–∏–º—É–º 8 —Å—Ç—Ä–æ–∫. –í –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –º–æ–∂–Ω–æ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∫–∞–∫—É—é-–Ω–∏–±—É–¥—å –≥–æ—Ç–æ–≤—É—é –≥—Ä–∞—Ñ–∏—á–µ—Å–∫—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –¥–∏—Å–ø–ª–µ—è –Ω–∞–ø–æ–¥–æ–±–∏–µ <a href="https://mazko.github.io/blog/posts/2017/05/20/ugfx-biblioteka-gui-dlia-mikrokontrollerov/">uGFX</a>.</p>
<p><a href="https://mazko.github.io/blog/posts/2017/04/26/freertos-operatsionnaia-sistema-dlia-mikrokontrollerov/">–î–∞–ª–µ–µ</a> –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ FreeRTOS.</p>
    </div><!-- /.entry-content -->
  </article>
</section>


<div class="body" id="proiot-comments">
  <div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'mazko';
      var disqus_identifier = 'blog/posts/2017/04/25/monokhromnyi-oled-displei-na-kontrollere-ssd1306/';
      var disqus_url = 'https://mazko.github.io/blog/posts/2017/04/25/monokhromnyi-oled-displei-na-kontrollere-ssd1306/';
      (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//mazko.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the comments.</noscript>
  </div>
</div>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a rel="nofollow" href="http://getpelican.com/">Pelican</a></li>
                            <li><a rel="nofollow" href="http://python.org/">Python.org</a></li>
                            <li><a rel="nofollow" href="http://jinja.pocoo.org/">Jinja2</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://mazko.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a rel="nofollow" href="http://github.com/mazko">github</a></li>
                            <li><a rel="nofollow" href="http://linkedin.com/in/mazko">linkedin</a></li>
                            <li><a rel="nofollow" href="http://stackoverflow.com/users/281102/oleg-mazko">stackoverflow</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'mazko';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>