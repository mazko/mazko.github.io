<!DOCTYPE html>
<html lang="ru">
<head>
        <meta charset="utf-8" />
        <title>ElasticSearch - –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤–≤–µ–¥–µ–Ω–∏–µ</title>
        <link rel="stylesheet" href="https://mazko.github.io/blog/theme/css/main.css" />
        <link href="https://mazko.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="üè† –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –í—Å–µ–≥–æ üöó Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
<a rel="nofollow" href="http://github.com/mazko">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="https://mazko.github.io/">üè† –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –í—Å–µ–≥–æ üöó </a></h1>
                <nav><ul>
                    <li class="active"><a href="https://mazko.github.io/blog/category/admin/">Admin</a></li>
                    <li><a href="https://mazko.github.io/blog/category/electronics/">Electronics</a></li>
                    <li><a href="https://mazko.github.io/blog/category/embedded/">Embedded</a></li>
                    <li><a href="https://mazko.github.io/blog/category/iot/">IoT</a></li>
                    <li><a href="https://mazko.github.io/blog/category/java/">Java</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://mazko.github.io/blog/posts/2016/06/25/elasticsearch-prakticheskoe-vvedenie/" rel="bookmark"
           title="Permalink to ElasticSearch - –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤–≤–µ–¥–µ–Ω–∏–µ">ElasticSearch - –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤–≤–µ–¥–µ–Ω–∏–µ</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-06-25T00:00:00+03:00">
                –°–± 25 –∏—é–Ω—è 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://mazko.github.io/blog/author/oleg-mazko/">Oleg Mazko</a>
        </address>
<p>In <a href="https://mazko.github.io/blog/category/admin/">Admin</a>.</p>
<p>tags: <a href="https://mazko.github.io/blog/tag/elastic">Elastic</a> <a href="https://mazko.github.io/blog/tag/rest">REST</a> <a href="https://mazko.github.io/blog/tag/docker">Docker</a> </p>
</footer><!-- /.post-info -->      <p><a href="https://www.elastic.co/products/elasticsearch" rel="nofollow">ElasticSearch</a> - –ø–æ–∏—Å–∫–æ–≤—ã–π –¥–≤–∏–∂–æ–∫ —Å JSON REST API, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º <a href="https://mazko.github.io/blog/posts/2012/10/15/lucene-kurs-molodogo-boitsa/">Lucene</a>. –ü—Ä–µ–¥–ª–∞–≥–∞—é —Å–º–∞—Å—Ç–µ—Ä–∏—Ç—å —Å –ø–æ–º–æ—â—å—é Elastic –ø–æ–∏—Å–∫ –¥–ª—è –ø–∞—Ä–æ—á–∫–∏ <a href="https://mazko.github.io/blog/posts/2016/05/15/lucene-fasetnyi-poisk/">—Ñ–∏–ª—å–º–æ–≤</a>. –ù–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–ø–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —É—Å—Ç–∞–Ω–æ–≤–∫—É –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Elastic –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –≤–ø—Ä–æ—á–µ–º —ç—Ç–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - –≤—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Elastic –ª—é–±—ã–º –¥—Ä—É–≥–∏–º <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/_installation.html" rel="nofollow">—Å–ø–æ—Å–æ–±–æ–º</a>. –ó–∞—Ç–µ–º –∫–æ–ø–Ω—ë–º –ø–æ–≥–ª—É–±–∂–µ –≤ <a href="https://mazko.github.io/blog/posts/2012/10/17/lucene-protsess-indeksatsii/">–ø—Ä–æ—Ü–µ—Å—Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏</a>, <a href="https://mazko.github.io/blog/posts/2012/10/29/lucene-sintaksis-zaprosov/">–ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã</a>,
<a href="https://mazko.github.io/blog/posts/2012/10/28/lucene-podsvetka-vkhozhdenii-v-rezultatakh-vydachi/">–ø–æ–¥—Å–≤–µ—Ç–∫—É</a> –≤—Ö–æ–∂–¥–µ–Ω–∏–π –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –≤—ã–¥–∞—á–∏ –∏ <a href="https://mazko.github.io/blog/posts/2016/05/15/lucene-fasetnyi-poisk/">–∞–≥—Ä–µ–≥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö</a> –≤ Elastic –∏ –≤—Å—ë —ç—Ç–æ —Ç–æ–ª—å–∫–æ –ª–∏—à—å —Å –ø–æ–º–æ—â—å—é REST API –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞–ª–∏—á–∏—è –∫–∞–∫–∏—Ö-–ª–∏–±–æ –≥–ª—É–±–æ–∫–∏—Ö –ø–æ–∑–Ω–∞–Ω–∏–π –∫–∞–∫ –≤ —Å–∞–º–æ–º Lucene —Ç–∞–∫ –∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤ —Ü–µ–ª–æ–º !</p>
<!-- cd ./dist/ && find . -type f | sort | xargs -I{} -n1 echo -e '<a href="\x7Battach\x7Ddist/{}"></a>' | xclip -selection clipboard && cd - -->

<!-- 
<a href="https://mazko.github.io/blog/posts/2016/06/25/elasticsearch-prakticheskoe-vvedenie/dist/bundle.js"></a>
<a href="https://mazko.github.io/blog/posts/2016/06/25/elasticsearch-prakticheskoe-vvedenie/dist/bundle.js.map"></a>
<a href="https://mazko.github.io/blog/posts/2016/06/25/elasticsearch-prakticheskoe-vvedenie/dist/favicon.ico"></a>
<a href="https://mazko.github.io/blog/posts/2016/06/25/elasticsearch-prakticheskoe-vvedenie/dist/index.html"></a>
-->

<h2>UI –î–ï–ú–û</h2>
<p>–î–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏–∑–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –Ω–∞–±—Ä–æ—Å–∞–ª –ø—Ä–æ—Å—Ç–µ–Ω—å–∫–∏–π UI (<a href="https://mazko.github.io/blog/posts/2016/06/25/elasticsearch-prakticheskoe-vvedenie/react-elastic-example.zip">–∏—Å—Ö–æ–¥–Ω–∏–∫–∏</a>) –Ω–∞ <a href="https://facebook.github.io/react/" rel="nofollow">ReactJS</a>. –î–ª—è —Ä–∞–±–æ—Ç—ã <a href="https://mazko.github.io/blog/posts/2016/06/25/elasticsearch-prakticheskoe-vvedenie/dist/index.html">–¥–µ–º–æ</a> –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω—É–∂–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ ElasticSearch, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Å–µ–π—á–∞—Å –Ω–∞—Å—Ç—Ä–æ–∏–º, —Ä–∞–∑—Ä–µ—à–∏—Ç—å <code>http.cors</code> –Ω–∞–ø—Ä–∏–º–µ—Ä <code>allow-origin: /https?:\/\/proiot\.ru/</code>, –ª–∏–±–æ –ø—Ä–æ—Å—Ç–æ –∑–≤—ë–∑–¥–æ—á–∫–∞  <code>*</code> - —Ä–∞–∑—Ä–µ—à–∏—Ç—å –æ—Ç–æ–≤—Å—é–¥—É.</p>
<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2016/06/25/elasticsearch-prakticheskoe-vvedenie/ui.gif" style="width:100%; border:1px solid #ddd;"></p>
<h2>TL;DR</h2>
<p>–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —á—Ç–æ ElasticSearch —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω:</p>
<div class="highlight"><pre><span></span>~$ curl -XGET localhost:9200
<span class="c1"># response</span>
<span class="o">{</span>
  <span class="s2">&quot;name&quot;</span> : <span class="s2">&quot;J2&quot;</span>,
  <span class="s2">&quot;cluster_name&quot;</span> : <span class="s2">&quot;docker-cluster&quot;</span>,
  <span class="s2">&quot;version&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;number&quot;</span> : <span class="s2">&quot;2.3.3&quot;</span>,
    <span class="s2">&quot;build_hash&quot;</span> : <span class="s2">&quot;218bdf10790eef486ff2c41a3df5cfa32dadcfde&quot;</span>,
    <span class="s2">&quot;build_timestamp&quot;</span> : <span class="s2">&quot;2016-05-17T15:40:04Z&quot;</span>,
    <span class="s2">&quot;build_snapshot&quot;</span> : false,
    <span class="s2">&quot;lucene_version&quot;</span> : <span class="s2">&quot;5.5.0&quot;</span>
  <span class="o">}</span>,
  <span class="s2">&quot;tagline&quot;</span> : <span class="s2">&quot;You Know, for Search&quot;</span>
<span class="o">}</span>
</pre></div>


<p>–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–∞–º–ø–∞ <a href="https://mazko.github.io/blog/posts/2016/06/25/elasticsearch-prakticheskoe-vvedenie/Top.bulk.json.xz">Top.bulk.json.xz</a>:</p>
<div class="highlight"><pre><span></span><span class="c1"># field mapping for suggest, aggregation</span>
<span class="c1"># curl -XDELETE &#39;localhost:9200/kinopoisk?pretty&#39;</span>
~$ curl -XPUT <span class="s1">&#39;localhost:9200/kinopoisk?pretty&#39;</span> -d <span class="s1">&#39;{</span>
<span class="s1">  &quot;mappings&quot;: {</span>
<span class="s1">    &quot;film&quot; : {</span>
<span class="s1">      &quot;properties&quot; : {</span>
<span class="s1">        &quot;suggest&quot; : { </span>
<span class="s1">          &quot;type&quot; : &quot;completion&quot;,</span>
<span class="s1">          &quot;analyzer&quot;: &quot;standard&quot;</span>
<span class="s1">        },</span>
<span class="s1">        &quot;category&quot;: {</span>
<span class="s1">          &quot;type&quot;: &quot;string&quot;,</span>
<span class="s1">          &quot;fields&quot;: {</span>
<span class="s1">              &quot;raw&quot;: {</span>
<span class="s1">                  &quot;type&quot;: &quot;string&quot;,</span>
<span class="s1">                  &quot;index&quot;: &quot;not_analyzed&quot;</span>
<span class="s1">              }</span>
<span class="s1">          }</span>
<span class="s1">        },</span>
<span class="s1">        &quot;directed&quot;: {</span>
<span class="s1">          &quot;type&quot;: &quot;string&quot;,</span>
<span class="s1">          &quot;fields&quot;: {</span>
<span class="s1">              &quot;raw&quot;: {</span>
<span class="s1">                  &quot;type&quot;: &quot;string&quot;,</span>
<span class="s1">                  &quot;index&quot;: &quot;not_analyzed&quot;</span>
<span class="s1">              }</span>
<span class="s1">          }</span>
<span class="s1">        },</span>
<span class="s1">        &quot;starring&quot;: {</span>
<span class="s1">          &quot;type&quot;: &quot;string&quot;,</span>
<span class="s1">          &quot;fields&quot;: {</span>
<span class="s1">              &quot;raw&quot;: {</span>
<span class="s1">                  &quot;type&quot;: &quot;string&quot;,</span>
<span class="s1">                  &quot;index&quot;: &quot;not_analyzed&quot;</span>
<span class="s1">              }</span>
<span class="s1">          }</span>
<span class="s1">        }</span>
<span class="s1">      }</span>
<span class="s1">    }</span>
<span class="s1">  }</span>
<span class="s1">}&#39;</span>

<span class="c1"># index 14992 docs(verify: echo `xzcat Top.bulk.json.xz | wc -l` / 2 | bc -l)</span>
~$ xzcat Top.bulk.json.xz <span class="p">|</span> curl -XPOST localhost:9200/_bulk --data-binary @-
</pre></div>


<p>–ü–æ–ª—è <em>category</em>, <em>directed</em>, <em>starring</em> –≤ —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏–∏ Elastic —è–≤–ª—è—é—Ç—Å—è <a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/_multi_fields.html" rel="nofollow">multi-field</a>, –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –æ–Ω–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ö—Ä–∞–Ω—è—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—ã–¥–∞—á—É –ø–æ —Å—Ç—Ä–æ–≥–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é - –Ω–∞–ø—Ä–∏–º–µ—Ä —Ä–µ–∂–∏—Å—Å—ë—Ä "–ò–≥–æ—Ä—å –ú–∞—Å–ª–µ–Ω–Ω–∏–∫–æ–≤" –≤–º–µ—Å—Ç–æ "–ò–≥–æ—Ä—å" –∏ "–ú–∞—Å–ª–µ–Ω–Ω–∏–∫–æ–≤" –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏. –ü–æ—Å–ª–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –º–æ–∂–Ω–æ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å –ø–æ–∏—Å–∫ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π, –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π, –∫ –æ—Å–æ–∑–Ω–∞–Ω–∏—é –∫–æ—Ç–æ—Ä–æ–≥–æ –±—ã–ª–æ –±—ã –∑–¥–æ—Ä–æ–≤–æ –ø–æ–¥–æ–π—Ç–∏ –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –¥–∞–Ω–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞:</p>
<div class="highlight"><pre><span></span>~$ curl -XGET <span class="s1">&#39;localhost:9200/kinopoisk/film/_search?pretty&#39;</span> -d <span class="s1">&#39; {</span>
<span class="s1">  &quot;fields&quot; : [&quot;rate&quot;],</span>
<span class="s1">  &quot;query&quot; : {</span>
<span class="s1">    &quot;bool&quot;: {</span>
<span class="s1">      &quot;must&quot;: [</span>
<span class="s1">        {</span>
<span class="s1">          &quot;query_string&quot; : {</span>
<span class="s1">            &quot;query&quot;:    &quot;—à–µ—Ä–ª–æ–∫&quot;, </span>
<span class="s1">            &quot;fields&quot;: [ &quot;name&quot;, &quot;description&quot; ],</span>
<span class="s1">            &quot;default_operator&quot;: &quot;and&quot;</span>
<span class="s1">          }</span>
<span class="s1">        }</span>
<span class="s1">      ],</span>
<span class="s1">      &quot;filter&quot;: [</span>
<span class="s1">        {</span>
<span class="s1">          &quot;match&quot;: {</span>
<span class="s1">            &quot;directed.raw&quot;: &quot;–ò–≥–æ—Ä—å –ú–∞—Å–ª–µ–Ω–Ω–∏–∫–æ–≤&quot;</span>
<span class="s1">          }</span>
<span class="s1">        },</span>
<span class="s1">        {</span>
<span class="s1">          &quot;bool&quot;: {</span>
<span class="s1">            &quot;must&quot;: [</span>
<span class="s1">              {</span>
<span class="s1">                &quot;match&quot;: {</span>
<span class="s1">                  &quot;category.raw&quot;: &quot;–¥–µ—Ç–µ–∫—Ç–∏–≤&quot;</span>
<span class="s1">                }</span>
<span class="s1">              },</span>
<span class="s1">              {</span>
<span class="s1">                &quot;match&quot;: {</span>
<span class="s1">                  &quot;category.raw&quot;: &quot;–∫—Ä–∏–º–∏–Ω–∞–ª&quot;</span>
<span class="s1">                }</span>
<span class="s1">              }</span>
<span class="s1">            ]</span>
<span class="s1">          }</span>
<span class="s1">        },</span>
<span class="s1">        {</span>
<span class="s1">          &quot;range&quot; : {</span>
<span class="s1">            &quot;date&quot; : {</span>
<span class="s1">              &quot;gte&quot; : &quot;1980&quot;,</span>
<span class="s1">              &quot;lt&quot; : &quot;1980||+1y&quot;,</span>
<span class="s1">              &quot;format&quot;: &quot;yyyy-MM||yyyy&quot;</span>
<span class="s1">            }</span>
<span class="s1">          }</span>
<span class="s1">        }</span>
<span class="s1">      ]</span>
<span class="s1">    }</span>
<span class="s1">  },</span>
<span class="s1">  &quot;highlight&quot; : {</span>
<span class="s1">    &quot;pre_tags&quot; : [&quot;[mazko.github.io]&quot;],</span>
<span class="s1">    &quot;post_tags&quot; : [&quot;[/mazko.github.io]&quot;],</span>
<span class="s1">    &quot;fields&quot; : {</span>
<span class="s1">      &quot;name&quot; : {&quot;fragment_size&quot; : 22, &quot;number_of_fragments&quot; : 1},</span>
<span class="s1">      &quot;description&quot; : {&quot;fragment_size&quot; : 22, &quot;number_of_fragments&quot; : 1}</span>
<span class="s1">    }</span>
<span class="s1">  },</span>
<span class="s1">  &quot;sort&quot; : [</span>
<span class="s1">      {&quot;rate&quot; : {&quot;order&quot; : &quot;desc&quot;} }</span>
<span class="s1">  ],</span>
<span class="s1">  &quot;aggs&quot;: {</span>
<span class="s1">    &quot;years&quot;: {</span>
<span class="s1">      &quot;date_histogram&quot;: {</span>
<span class="s1">        &quot;field&quot;: &quot;date&quot;,</span>
<span class="s1">        &quot;interval&quot;: &quot;year&quot;,</span>
<span class="s1">        &quot;min_doc_count&quot;: 1,</span>
<span class="s1">        &quot;order&quot; : { &quot;_count&quot; : &quot;desc&quot; }</span>
<span class="s1">      },</span>
<span class="s1">      &quot;aggs&quot;: {</span>
<span class="s1">        &quot;months&quot;: {</span>
<span class="s1">          &quot;date_histogram&quot;: {</span>
<span class="s1">            &quot;field&quot;: &quot;date&quot;,</span>
<span class="s1">            &quot;interval&quot;: &quot;month&quot;,</span>
<span class="s1">            &quot;min_doc_count&quot;: 1,</span>
<span class="s1">            &quot;order&quot; : { &quot;_count&quot; : &quot;desc&quot; }</span>
<span class="s1">          }</span>
<span class="s1">        }</span>
<span class="s1">      }</span>
<span class="s1">    },</span>
<span class="s1">    &quot;categories&quot; : {</span>
<span class="s1">      &quot;terms&quot; : { &quot;field&quot; : &quot;category.raw&quot;, &quot;size&quot;: 0 }</span>
<span class="s1">    },</span>
<span class="s1">    &quot;directors&quot; : {</span>
<span class="s1">      &quot;terms&quot; : { &quot;field&quot; : &quot;directed.raw&quot;, &quot;size&quot;: 0 }</span>
<span class="s1">    },</span>
<span class="s1">    &quot;stars&quot; : {</span>
<span class="s1">      &quot;terms&quot; : { &quot;field&quot; : &quot;starring.raw&quot;, &quot;size&quot;: 0 }</span>
<span class="s1">    }</span>
<span class="s1">  }</span>
<span class="s1">}&#39;</span>
<span class="c1"># response</span>
<span class="o">{</span>
  <span class="s2">&quot;took&quot;</span> : <span class="m">3117</span>,
  <span class="s2">&quot;timed_out&quot;</span> : false,
  <span class="s2">&quot;_shards&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;total&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;successful&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;failed&quot;</span> : <span class="m">0</span>
  <span class="o">}</span>,
  <span class="s2">&quot;hits&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;total&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;max_score&quot;</span> : null,
    <span class="s2">&quot;hits&quot;</span> : <span class="o">[</span> <span class="o">{</span>
      <span class="s2">&quot;_index&quot;</span> : <span class="s2">&quot;kinopoisk&quot;</span>,
      <span class="s2">&quot;_type&quot;</span> : <span class="s2">&quot;film&quot;</span>,
      <span class="s2">&quot;_id&quot;</span> : <span class="s2">&quot;77269&quot;</span>,
      <span class="s2">&quot;_score&quot;</span> : null,
      <span class="s2">&quot;fields&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;rate&quot;</span> : <span class="o">[</span> <span class="m">8</span>.415 <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">&quot;highlight&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;name&quot;</span> : <span class="o">[</span> <span class="s2">&quot;[mazko.github.io]–®–µ—Ä–ª–æ–∫[/mazko.github.io] –•–æ–ª–º—Å –∏ –¥–æ–∫—Ç–æ—Ä&quot;</span> <span class="o">]</span>,
        <span class="s2">&quot;description&quot;</span> : <span class="o">[</span> <span class="s2">&quot; [mazko.github.io]–®–µ—Ä–ª–æ–∫[/mazko.github.io] –•–æ–ª–º—Å. –≠—Ç–æ&quot;</span> <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">&quot;sort&quot;</span> : <span class="o">[</span> <span class="m">8</span>.415 <span class="o">]</span>
    <span class="o">}</span>, <span class="o">{</span>
      <span class="s2">&quot;_index&quot;</span> : <span class="s2">&quot;kinopoisk&quot;</span>,
      <span class="s2">&quot;_type&quot;</span> : <span class="s2">&quot;film&quot;</span>,
      <span class="s2">&quot;_id&quot;</span> : <span class="s2">&quot;354799&quot;</span>,
      <span class="s2">&quot;_score&quot;</span> : null,
      <span class="s2">&quot;fields&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;rate&quot;</span> : <span class="o">[</span> <span class="m">8</span>.313 <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">&quot;highlight&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;name&quot;</span> : <span class="o">[</span> <span class="s2">&quot;[mazko.github.io]–®–µ—Ä–ª–æ–∫[/mazko.github.io] –•–æ–ª–º—Å –∏ –¥–æ–∫—Ç–æ—Ä&quot;</span> <span class="o">]</span>,
        <span class="s2">&quot;description&quot;</span> : <span class="o">[</span> <span class="s2">&quot;[mazko.github.io]–®–µ—Ä–ª–æ–∫[/mazko.github.io] –•–æ–ª–º—Å –≤—Å—Ç—É–ø–∏–ª&quot;</span> <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">&quot;sort&quot;</span> : <span class="o">[</span> <span class="m">8</span>.313 <span class="o">]</span>
    <span class="o">}</span>, <span class="o">{</span>
      <span class="s2">&quot;_index&quot;</span> : <span class="s2">&quot;kinopoisk&quot;</span>,
      <span class="s2">&quot;_type&quot;</span> : <span class="s2">&quot;film&quot;</span>,
      <span class="s2">&quot;_id&quot;</span> : <span class="s2">&quot;77265&quot;</span>,
      <span class="s2">&quot;_score&quot;</span> : null,
      <span class="s2">&quot;fields&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;rate&quot;</span> : <span class="o">[</span> <span class="m">8</span>.297 <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">&quot;highlight&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;name&quot;</span> : <span class="o">[</span> <span class="s2">&quot;[mazko.github.io]–®–µ—Ä–ª–æ–∫[/mazko.github.io] –•–æ–ª–º—Å –∏ –¥–æ–∫—Ç–æ—Ä&quot;</span> <span class="o">]</span>,
        <span class="s2">&quot;description&quot;</span> : <span class="o">[</span> <span class="s2">&quot;. –í–æ¬†–≤—Ç–æ—Ä–æ–π¬†‚Äî [mazko.github.io]–®–µ—Ä–ª–æ–∫[/mazko.github.io]&quot;</span> <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">&quot;sort&quot;</span> : <span class="o">[</span> <span class="m">8</span>.297 <span class="o">]</span>
    <span class="o">}</span>, <span class="o">{</span>
      <span class="s2">&quot;_index&quot;</span> : <span class="s2">&quot;kinopoisk&quot;</span>,
      <span class="s2">&quot;_type&quot;</span> : <span class="s2">&quot;film&quot;</span>,
      <span class="s2">&quot;_id&quot;</span> : <span class="s2">&quot;368937&quot;</span>,
      <span class="s2">&quot;_score&quot;</span> : null,
      <span class="s2">&quot;fields&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;rate&quot;</span> : <span class="o">[</span> <span class="m">8</span>.269 <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">&quot;highlight&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;description&quot;</span> : <span class="o">[</span> <span class="s2">&quot; –≤–æ–¥–æ–ø–∞–¥–∞. [mazko.github.io]–®–µ—Ä–ª–æ–∫[/mazko.github.io] –•–æ–ª–º—Å&quot;</span> <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">&quot;sort&quot;</span> : <span class="o">[</span> <span class="m">8</span>.269 <span class="o">]</span>
    <span class="o">}</span>, <span class="o">{</span>
      <span class="s2">&quot;_index&quot;</span> : <span class="s2">&quot;kinopoisk&quot;</span>,
      <span class="s2">&quot;_type&quot;</span> : <span class="s2">&quot;film&quot;</span>,
      <span class="s2">&quot;_id&quot;</span> : <span class="s2">&quot;368936&quot;</span>,
      <span class="s2">&quot;_score&quot;</span> : null,
      <span class="s2">&quot;fields&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;rate&quot;</span> : <span class="o">[</span> <span class="m">8</span>.248 <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">&quot;highlight&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;name&quot;</span> : <span class="o">[</span> <span class="s2">&quot;[mazko.github.io]–®–µ—Ä–ª–æ–∫[/mazko.github.io] –•–æ–ª–º—Å –∏ –¥–æ–∫—Ç–æ—Ä&quot;</span> <span class="o">]</span>,
        <span class="s2">&quot;description&quot;</span> : <span class="o">[</span> <span class="s2">&quot;¬†—É–≥—Ä–æ–∑–æ–π. [mazko.github.io]–®–µ—Ä–ª–æ–∫[/mazko.github.io] –•–æ–ª–º—Å&quot;</span> <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">&quot;sort&quot;</span> : <span class="o">[</span> <span class="m">8</span>.248 <span class="o">]</span>
    <span class="o">}</span> <span class="o">]</span>
  <span class="o">}</span>,
  <span class="s2">&quot;aggregations&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;directors&quot;</span> : <span class="o">{</span>
      <span class="s2">&quot;doc_count_error_upper_bound&quot;</span> : <span class="m">0</span>,
      <span class="s2">&quot;sum_other_doc_count&quot;</span> : <span class="m">0</span>,
      <span class="s2">&quot;buckets&quot;</span> : <span class="o">[</span> <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ò–≥–æ—Ä—å –ú–∞—Å–ª–µ–Ω–Ω–∏–∫–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">5</span>
      <span class="o">}</span> <span class="o">]</span>
    <span class="o">}</span>,
    <span class="s2">&quot;categories&quot;</span> : <span class="o">{</span>
      <span class="s2">&quot;doc_count_error_upper_bound&quot;</span> : <span class="m">0</span>,
      <span class="s2">&quot;sum_other_doc_count&quot;</span> : <span class="m">0</span>,
      <span class="s2">&quot;buckets&quot;</span> : <span class="o">[</span> <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–¥–µ—Ç–µ–∫—Ç–∏–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">5</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–∫—Ä–∏–º–∏–Ω–∞–ª&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">5</span>
      <span class="o">}</span> <span class="o">]</span>
    <span class="o">}</span>,
    <span class="s2">&quot;stars&quot;</span> : <span class="o">{</span>
      <span class="s2">&quot;doc_count_error_upper_bound&quot;</span> : <span class="m">0</span>,
      <span class="s2">&quot;sum_other_doc_count&quot;</span> : <span class="m">0</span>,
      <span class="s2">&quot;buckets&quot;</span> : <span class="o">[</span> <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–í–∞—Å–∏–ª–∏–π –õ–∏–≤–∞–Ω–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">5</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–í–∏—Ç–∞–ª–∏–π –°–æ–ª–æ–º–∏–Ω&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">5</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–†–∏–Ω–∞ –ó–µ–ª–µ–Ω–∞—è&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">5</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ë–æ—Ä–∏—Å–ª–∞–≤ –ë—Ä–æ–Ω–¥—É–∫–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">4</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ë–æ—Ä–∏—Å –ö–ª—é–µ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">3</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ó–∞—Ö–∞—Ä–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ê–ª–µ–∫—Å–µ–π –ö–æ–∂–µ–≤–Ω–∏–∫–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–í–∞–ª–µ–Ω—Ç–∏–Ω–∞ –ü–∞–Ω–∏–Ω–∞&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–í–∏–∫—Ç–æ—Ä –ï–≤–≥—Ä–∞—Ñ–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ò–≥–æ—Ä—å –î–º–∏—Ç—Ä–∏–µ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ò–≥–æ—Ä—å –ï—Ñ–∏–º–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ù–∏–∫–æ–ª–∞–π –ö—Ä—é–∫–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ê–¥–æ–ª—å—Ñ –ò–ª—å–∏–Ω&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">1</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ê–Ω–∞—Ç–æ–ª–∏–π –ü–æ–¥—à–∏–≤–∞–ª–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">1</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ë–æ—Ä–∏—Å –†—ã–∂—É—Ö–∏–Ω&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">1</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–í–∏–∫—Ç–æ—Ä –ê—Ä–∏—Å—Ç–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">1</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–í–∏—Ç–∞–ª–∏–π –ë–∞–≥–∞–Ω–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">1</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ì–µ–Ω–Ω–∞–¥–∏–π –ë–æ–≥–∞—á—ë–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">1</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ò–≥–Ω–∞—Ç –õ–µ–π—Ä–µ—Ä&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">1</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ö–∞—Ç–µ—Ä–∏–Ω–∞ –®–µ–ª–ª&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">1</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ú–∞—Ä–∏—è –°–æ–ª–æ–º–∏–Ω–∞&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">1</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ù–∏–∫–æ–ª–∞–π –ö–∞—Ä–∞—á–µ–Ω—Ü–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">1</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–°–≤–µ—Ç–ª–∞–Ω–∞ –ö—Ä—é—á–∫–æ–≤–∞&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">1</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–§–µ–¥–æ—Ä –û–¥–∏–Ω–æ–∫–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">1</span>
      <span class="o">}</span> <span class="o">]</span>
    <span class="o">}</span>,
    <span class="s2">&quot;years&quot;</span> : <span class="o">{</span>
      <span class="s2">&quot;buckets&quot;</span> : <span class="o">[</span> <span class="o">{</span>
        <span class="s2">&quot;key_as_string&quot;</span> : <span class="s2">&quot;1980-01-01T00:00:00.000Z&quot;</span>,
        <span class="s2">&quot;key&quot;</span> : <span class="m">315532800000</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">5</span>,
        <span class="s2">&quot;months&quot;</span> : <span class="o">{</span>
          <span class="s2">&quot;buckets&quot;</span> : <span class="o">[</span> <span class="o">{</span>
            <span class="s2">&quot;key_as_string&quot;</span> : <span class="s2">&quot;1980-01-01T00:00:00.000Z&quot;</span>,
            <span class="s2">&quot;key&quot;</span> : <span class="m">315532800000</span>,
            <span class="s2">&quot;doc_count&quot;</span> : <span class="m">3</span>
          <span class="o">}</span>, <span class="o">{</span>
            <span class="s2">&quot;key_as_string&quot;</span> : <span class="s2">&quot;1980-03-01T00:00:00.000Z&quot;</span>,
            <span class="s2">&quot;key&quot;</span> : <span class="m">320716800000</span>,
            <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
          <span class="o">}</span> <span class="o">]</span>
        <span class="o">}</span>
      <span class="o">}</span> <span class="o">]</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>–í –∑–∞–ø—Ä–æ—Å–µ –º—ã –∏—Å–∫–∞–ª–∏ —Å—Ç—Ä–æ–∫—É <em>—à–µ—Ä–ª–æ–∫</em> –ø–æ –ø–æ–ª—è–º <em>name</em> –∏ <em>description</em>, –∏—Å–∫–ª—é—á–∏–ª–∏ –≤—Å–µ —Ñ–∏–ª—å–º—ã –∫—Ä–æ–º–µ —Ä–µ–∂–∏—Å—Å—ë—Ä–∞ "–ò–≥–æ—Ä—å –ú–∞—Å–ª–µ–Ω–Ω–∏–∫–æ–≤", –∂–∞–Ω—Ä—ã –¥–æ–∂–Ω—ã –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –∏ <em>–¥–µ—Ç–µ–∫—Ç–∏–≤</em> –∏ <em>–∫—Ä–∏–º–∏–Ω–∞–ª</em>, —Ç–æ–ª—å–∫–æ 1980 –≥–æ–¥. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –ø–æ–ª—é <em>rate</em>. –ü—Ä–æ—Å—Ç–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –ø–æ–ª—è–º <em>category</em>, <em>directed</em> –∏ <em>starring</em>. –í–ª–æ–∂–µ–Ω–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ - –≥–æ–¥—ã –∏ –≤ –Ω–∏—Ö –º–µ—Å—è—Ü—ã. –ù–æ –æ–±–æ –≤—Å—ë–º –ø–æ –ø–æ—Ä—è–¥–∫—É :)</p>
<h2>–£–°–¢–ê–ù–û–í–ö–ê –ò –ù–ê–°–¢–†–û–ô–ö–ê ELASTICSEARCH</h2>
<p>–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —á—Ç–æ –≤ —Å–∏—Å—Ç–µ–º–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω <a href="https://docs.docker.com/engine/installation/" rel="nofollow">Docker</a>:</p>
<div class="highlight"><pre><span></span>~$ docker -v
Docker version <span class="m">1</span>.11.2, build b9f10c9

~$ docker pull ubuntu <span class="o">&amp;&amp;</span> docker run -it ubuntu

root@d1b1c0c6bddc:/# cat /etc/lsb-release
<span class="nv">DISTRIB_ID</span><span class="o">=</span>Ubuntu
<span class="nv">DISTRIB_RELEASE</span><span class="o">=</span><span class="m">16</span>.04
<span class="nv">DISTRIB_CODENAME</span><span class="o">=</span>xenial
<span class="nv">DISTRIB_DESCRIPTION</span><span class="o">=</span><span class="s2">&quot;Ubuntu 16.04 LTS&quot;</span>

root@d1b1c0c6bddc:/# apt update <span class="o">&amp;&amp;</span> apt -y upgrade <span class="o">&amp;&amp;</span> <span class="se">\</span>
  apt -y install software-properties-common command-not-found <span class="se">\</span>
  man-db openjdk-8-jdk wget curl net-tools

root@d1b1c0c6bddc:/# wget -qO - https://packages.elastic.co/GPG-KEY-elasticsearch <span class="p">|</span> apt-key add -

root@d1b1c0c6bddc:/# <span class="nb">echo</span> <span class="s2">&quot;deb https://packages.elastic.co/elasticsearch/2.x/debian stable main&quot;</span> <span class="p">|</span><span class="se">\</span>
  tee -a /etc/apt/sources.list.d/elasticsearch-2.x.list

root@d1b1c0c6bddc:/# apt -y install apt-transport-https <span class="o">&amp;&amp;</span> apt update <span class="o">&amp;&amp;</span> apt install -y elasticsearch

root@d1b1c0c6bddc:/# <span class="nb">cd</span> /usr/share/elasticsearch/
root@d1b1c0c6bddc:/# mkdir config/ <span class="o">&amp;&amp;</span> chown elasticsearch:elasticsearch config/
root@d1b1c0c6bddc:/# mkdir logs/ <span class="o">&amp;&amp;</span> chown elasticsearch:elasticsearch logs/
root@d1b1c0c6bddc:/# mkdir data/ <span class="o">&amp;&amp;</span> chown elasticsearch:elasticsearch data/

root@d1b1c0c6bddc:/# cat <span class="s">&lt;&lt;EOT &gt; /usr/share/elasticsearch/config/logging.yml</span>
<span class="s">rootLogger: TRACE,console</span>
<span class="s">appender:</span>
<span class="s">  console:</span>
<span class="s">    type: console</span>
<span class="s">    layout:</span>
<span class="s">      type: consolePattern</span>
<span class="s">      conversionPattern: &quot;[%d{ISO8601}][%-5p][%-25c] %m%n&quot;</span>
<span class="s">EOT</span>

root@d1b1c0c6bddc:/# cat <span class="s">&lt;&lt;EOT &gt; /usr/share/elasticsearch/config/elasticsearch.yml</span>
<span class="s">cluster.name: &quot;docker-cluster&quot;</span>
<span class="s">network.host: 0.0.0.0</span>
<span class="s">http.max_content_length: 333mb</span>
<span class="s">http.cors:</span>
<span class="s">  enabled: true </span>
<span class="s">  allow-origin: /https?:\/\/localhost(:[0-9]+)?/</span>
<span class="s">  allow-methods: OPTIONS, HEAD, GET, POST, PUT, DELETE</span>
<span class="s">  allow-headers: X-Requested-With,X-Auth-Token,Content-Type, Content-Length</span>
<span class="s">EOT</span>

root@d1b1c0c6bddc:/# <span class="nb">exit</span>
</pre></div>


<p>–í <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-http.html#_settings_2" rel="nofollow">–Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö</a> –º—ã –¥–æ–±–∞–≤–∏–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É <code>http.cors</code> —á—Ç–æ–±—ã —Å elastic –º–æ–∂–Ω–æ –±—ã–ª–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞. –ù–∞ —ç—Ç–æ–º —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ - –æ—Å—Ç–∞–ª–æ—Å—å –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–∑:</p>
<div class="highlight"><pre><span></span>~$ docker commit d1b1c0c6bddc elastic
~$ docker rm d1b1c0c6bddc

~$ docker run --rm -it -u elasticsearch -p <span class="m">9200</span>:9200 elastic <span class="se">\</span>
  /usr/share/elasticsearch/bin/elasticsearch
</pre></div>


<p>–ü—Ä–æ–≤–µ—Ä–∫–∞ <code>http.cors</code>:</p>
<div class="highlight"><pre><span></span>~$ curl -I -H <span class="s1">&#39;Origin: http://localhost:8080&#39;</span> <span class="s1">&#39;http://localhost:9200/&#39;</span>
<span class="c1"># response</span>
HTTP/1.1 <span class="m">200</span> OK
Access-Control-Allow-Origin: http://localhost:8080
Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8
Content-Length: <span class="m">0</span>

~$ curl -I -H <span class="s1">&#39;Origin: http://some.hacker.com&#39;</span> <span class="s1">&#39;http://localhost:9200/&#39;</span>
<span class="c1"># response</span>
HTTP/1.1 <span class="m">403</span> Forbidden
</pre></div>


<p>–í –Ω–∞—Å—Ç–æ–π–∫–∞—Ö <code>http.cors</code> –Ω–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ some.hacker.com –ø–æ—ç—Ç–æ–º—É —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ 403. –ù–∞–∫–æ–Ω–µ—Ü –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –æ–±—Ä–∞–∑–∞ elastic —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –ø–æ—Å–ª–µ –µ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞:</p>
<div class="highlight"><pre><span></span>~$ docker volume create --name elastic-data

<span class="c1"># user: elasticsearch, port forward 9200, image: elastic, volume: elastic-data</span>
~$ docker run --rm -it -u elasticsearch -p <span class="m">9200</span>:9200 <span class="se">\</span>
  -v elastic-data:/usr/share/elasticsearch/data elastic <span class="se">\</span>
  /usr/share/elasticsearch/bin/elasticsearch
</pre></div>


<p>–° Docker –≤—Å—ë.</p>
<h2>REST API</h2>
<p>–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è:</p>
<div class="highlight"><pre><span></span>~$ curl -XPOST <span class="s1">&#39;localhost:9200/kinopoisk/film?pretty&#39;</span> -d <span class="o">{</span><span class="s1">&#39;</span>
<span class="s1">  &quot;id&quot;: 409640,</span>
<span class="s1">  &quot;name&quot;: &quot;–ö–∞—Å–ª (—Å–µ—Ä–∏–∞–ª 2009 ‚Äì ...)&quot;,</span>
<span class="s1">  &quot;description&quot;: &quot;–ó–Ω–∞–∫–æ–º—å—Ç–µ—Å—å, –†–∏—á–∞—Ä–¥ –ö–∞—Å–ª¬†‚Äî¬†—É—Å–ø–µ—à–Ω—ã–π –ø–∏—Å–∞—Ç–µ–ª—å –¥–µ—Ç–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∂–∞–Ω—Ä–∞...&quot;,</span>
<span class="s1">  &quot;date&quot;: &quot;2009-03-08T22:00:00.000Z&quot;,</span>
<span class="s1">  &quot;rate&quot;: 8.042,</span>
<span class="s1">  &quot;starring&quot;: [</span>
<span class="s1">    &quot;–ù—ç–π—Ç–∞–Ω –§–∏–ª–ª–∏–æ–Ω&quot;,</span>
<span class="s1">    &quot;–°—Ç–∞–Ω–∞ –ö–∞—Ç–∏–∫&quot;,</span>
<span class="s1">    &quot;–°—å—é–∑—ç–Ω –°–∞–ª–ª–∏–≤–∞–Ω&quot;,</span>
<span class="s1">    &quot;–î–∂–æ–Ω –£—ç—Ä—Ç–∞—Å&quot;,</span>
<span class="s1">    &quot;–®–µ–π–º—É—Å –î–µ–≤–µ—Ä&quot;,</span>
<span class="s1">    &quot;–ú–æ–ª–ª–∏ –ö. –ö—É–∏–Ω–Ω&quot;,</span>
<span class="s1">    &quot;–¢–∞–º–∞–ª–∞ –î–∂–æ–Ω—Å&quot;,</span>
<span class="s1">    &quot;–ü–µ–Ω–Ω–∏ –î–∂–æ–Ω—Å–æ–Ω&quot;,</span>
<span class="s1">    &quot;–†—É–±–µ–Ω –°–∞–Ω—Ç—å—è–≥–æ-–•–∞–¥—Å–æ–Ω&quot;,</span>
<span class="s1">    &quot;–ú–∞–π—è –°—Ç–æ—è–Ω&quot;</span>
<span class="s1">  ],</span>
<span class="s1">  &quot;category&quot;: [</span>
<span class="s1">    &quot;–¥—Ä–∞–º–∞&quot;,</span>
<span class="s1">    &quot;–º–µ–ª–æ–¥—Ä–∞–º–∞&quot;,</span>
<span class="s1">    &quot;–∫–æ–º–µ–¥–∏—è&quot;,</span>
<span class="s1">    &quot;–∫—Ä–∏–º–∏–Ω–∞–ª&quot;,</span>
<span class="s1">    &quot;–¥–µ—Ç–µ–∫—Ç–∏–≤&quot;</span>
<span class="s1">  ],</span>
<span class="s1">  &quot;directed&quot;: [</span>
<span class="s1">    &quot;–†–æ–± –ë–æ—É–º–µ–Ω&quot;,</span>
<span class="s1">    &quot;–î–∂–æ–Ω –¢–µ—Ä–ª–µ—Å–∫–∏&quot;,</span>
<span class="s1">    &quot;–ë–∏–ª–ª –†–æ—É&quot;</span>
<span class="s1">  ]</span>
<span class="s1">}&#39;</span>
<span class="c1"># response</span>
<span class="o">{</span>
  <span class="s2">&quot;_index&quot;</span> : <span class="s2">&quot;kinopoisk&quot;</span>,
  <span class="s2">&quot;_type&quot;</span> : <span class="s2">&quot;film&quot;</span>,
  <span class="s2">&quot;_id&quot;</span> : <span class="s2">&quot;AVWHlznJTgOouHAvlXph&quot;</span>,
  <span class="s2">&quot;_version&quot;</span> : <span class="m">1</span>,
  <span class="s2">&quot;_shards&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;total&quot;</span> : <span class="m">2</span>,
    <span class="s2">&quot;successful&quot;</span> : <span class="m">1</span>,
    <span class="s2">&quot;failed&quot;</span> : <span class="m">0</span>
  <span class="o">}</span>,
  <span class="s2">&quot;created&quot;</span> : <span class="nb">true</span>
<span class="o">}</span>

~$ curl -XPOST <span class="s1">&#39;localhost:9200/kinopoisk/film?pretty&#39;</span> -d <span class="o">{</span><span class="s1">&#39;</span>
<span class="s1">  &quot;id&quot;: 153013,</span>
<span class="s1">  &quot;name&quot;: &quot;–ó–≤–µ–∑–¥–Ω—ã–π –∫—Ä–µ–π—Å–µ—Ä –ì–∞–ª–∞–∫—Ç–∏–∫–∞ (—Å–µ—Ä–∏–∞–ª 2004 ‚Äì 2009)&quot;,</span>
<span class="s1">  &quot;description&quot;: &quot;–ß—É–¥–æ–º —É—Ü–µ–ª–µ–≤ –ø–æ—Å–ª–µ –Ω–∞–ø–∞–¥–µ–Ω–∏—è –°–∞–π–ª–æ–Ω–æ–≤...&quot;,</span>
<span class="s1">  &quot;date&quot;: &quot;2004-10-17T21:00:00.000Z&quot;,</span>
<span class="s1">  &quot;rate&quot;: 7.943,</span>
<span class="s1">  &quot;starring&quot;: [</span>
<span class="s1">    &quot;–≠–¥–≤–∞—Ä–¥ –î–∂–µ–π–º—Å –û–ª–º–æ—Å&quot;,</span>
<span class="s1">    &quot;–ú—ç—Ä–∏ –ú–∞–∫–î–æ–Ω–Ω–µ–ª–ª&quot;,</span>
<span class="s1">    &quot;–î–∂–µ–π–º–∏ –ë–∞–º–±–µ—Ä&quot;,</span>
<span class="s1">    &quot;–î–∂–µ–π–º—Å –ö—ç–ª–ª–∏—Å&quot;,</span>
<span class="s1">    &quot;–¢—Ä–∏—à–∞ –•–µ–ª—Ñ–µ—Ä&quot;,</span>
<span class="s1">    &quot;–ì—Ä–µ–π—Å –ü–∞–∫&quot;,</span>
<span class="s1">    &quot;–ö—ç—Ç–∏ –°–∞–∫—Ö–æ—Ñ—Ñ&quot;,</span>
<span class="s1">    &quot;–ú–∞–π–∫–ª –•–æ–≥–∞–Ω&quot;,</span>
<span class="s1">    &quot;–ê–∞—Ä–æ–Ω –î—É–≥–ª–∞—Å&quot;,</span>
<span class="s1">    &quot;–¢–∞–º–æ –ü–µ–Ω–∏–∫–µ—Ç—Ç&quot;</span>
<span class="s1">  ],</span>
<span class="s1">  &quot;category&quot;: [</span>
<span class="s1">    &quot;—Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞&quot;,</span>
<span class="s1">    &quot;–±–æ–µ–≤–∏–∫&quot;,</span>
<span class="s1">    &quot;–¥—Ä–∞–º–∞&quot;,</span>
<span class="s1">    &quot;–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è&quot;</span>
<span class="s1">  ],</span>
<span class="s1">  &quot;directed&quot;: [</span>
<span class="s1">    &quot;–ú–∞–π–∫–ª –†–∞–π–º–µ—Ä&quot;,</span>
<span class="s1">    &quot;–ú–∞–π–∫–ª –ù–∞–Ω–∫–∏–Ω&quot;,</span>
<span class="s1">    &quot;–†–æ–¥ –•–∞—Ä–¥–∏&quot;</span>
<span class="s1">  ]</span>
<span class="s1">}&#39;</span>
<span class="c1"># response</span>
<span class="o">{</span>
  <span class="s2">&quot;_index&quot;</span> : <span class="s2">&quot;kinopoisk&quot;</span>,
  <span class="s2">&quot;_type&quot;</span> : <span class="s2">&quot;film&quot;</span>,
  <span class="s2">&quot;_id&quot;</span> : <span class="s2">&quot;AVWHnN7ATgOouHAvlXpl&quot;</span>,
  <span class="s2">&quot;_version&quot;</span> : <span class="m">1</span>,
  <span class="s2">&quot;_shards&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;total&quot;</span> : <span class="m">2</span>,
    <span class="s2">&quot;successful&quot;</span> : <span class="m">1</span>,
    <span class="s2">&quot;failed&quot;</span> : <span class="m">0</span>
  <span class="o">}</span>,
  <span class="s2">&quot;created&quot;</span> : <span class="nb">true</span>
<span class="o">}</span>

~$ curl -XGET <span class="s1">&#39;localhost:9200/kinopoisk/_mapping?pretty&#39;</span>
<span class="c1"># response</span>
<span class="o">{</span>
  <span class="s2">&quot;kinopoisk&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;mappings&quot;</span> : <span class="o">{</span>
      <span class="s2">&quot;film&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;properties&quot;</span> : <span class="o">{</span>
          <span class="s2">&quot;category&quot;</span> : <span class="o">{</span>
            <span class="s2">&quot;type&quot;</span> : <span class="s2">&quot;string&quot;</span>
          <span class="o">}</span>,
          <span class="s2">&quot;date&quot;</span> : <span class="o">{</span>
            <span class="s2">&quot;type&quot;</span> : <span class="s2">&quot;date&quot;</span>,
            <span class="s2">&quot;format&quot;</span> : <span class="s2">&quot;strict_date_optional_time||epoch_millis&quot;</span>
          <span class="o">}</span>,
          <span class="s2">&quot;description&quot;</span> : <span class="o">{</span>
            <span class="s2">&quot;type&quot;</span> : <span class="s2">&quot;string&quot;</span>
          <span class="o">}</span>,
          <span class="s2">&quot;directed&quot;</span> : <span class="o">{</span>
            <span class="s2">&quot;type&quot;</span> : <span class="s2">&quot;string&quot;</span>
          <span class="o">}</span>,
          <span class="s2">&quot;id&quot;</span> : <span class="o">{</span>
            <span class="s2">&quot;type&quot;</span> : <span class="s2">&quot;long&quot;</span>
          <span class="o">}</span>,
          <span class="s2">&quot;name&quot;</span> : <span class="o">{</span>
            <span class="s2">&quot;type&quot;</span> : <span class="s2">&quot;string&quot;</span>
          <span class="o">}</span>,
          <span class="s2">&quot;rate&quot;</span> : <span class="o">{</span>
            <span class="s2">&quot;type&quot;</span> : <span class="s2">&quot;double&quot;</span>
          <span class="o">}</span>,
          <span class="s2">&quot;starring&quot;</span> : <span class="o">{</span>
            <span class="s2">&quot;type&quot;</span> : <span class="s2">&quot;string&quot;</span>
          <span class="o">}</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>ElasticSearch –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –¥–∞–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª–µ–π –≤ –∏–Ω–¥–µ–∫—Å–µ ! –ü—Ä–æ—Å—Ç–æ–π <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-from-size.html" rel="nofollow">–ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã–π</a> –ø–æ–∏—Å–∫ –ø–æ –¥–≤—É–º –ø–æ–ª—è–º <em>name</em> –∏ <em>description</em>, –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –ø–æ–∏—Å–∫–∞ –≤—ã–≤–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª–µ–π <em>id</em>, <em>rate</em>:</p>
<div class="highlight"><pre><span></span>~$ curl -XGET <span class="s1">&#39;localhost:9200/kinopoisk/film/_search?pretty&#39;</span> -d <span class="o">{</span><span class="s1">&#39;</span>
<span class="s1">    &quot;fields&quot; : [&quot;id&quot;, &quot;rate&quot;],</span>
<span class="s1">    &quot;query&quot; : {</span>
<span class="s1">      &quot;query_string&quot; : {</span>
<span class="s1">        &quot;query&quot;:    &quot;–ö–∞—Å–ª&quot;, </span>
<span class="s1">        &quot;fields&quot;: [ &quot;name&quot;, &quot;description&quot; ],</span>
<span class="s1">        &quot;default_operator&quot;: &quot;and&quot;</span>
<span class="s1">      }</span>
<span class="s1">    }</span>
<span class="s1">}&#39;</span>
<span class="c1"># response</span>
<span class="o">{</span>
  <span class="s2">&quot;took&quot;</span> : <span class="m">8</span>,
  <span class="s2">&quot;timed_out&quot;</span> : false,
  <span class="s2">&quot;_shards&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;total&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;successful&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;failed&quot;</span> : <span class="m">0</span>
  <span class="o">}</span>,
  <span class="s2">&quot;hits&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;total&quot;</span> : <span class="m">1</span>,
    <span class="s2">&quot;max_score&quot;</span> : <span class="m">0</span>.15342641,
    <span class="s2">&quot;hits&quot;</span> : <span class="o">[</span> <span class="o">{</span>
      <span class="s2">&quot;_index&quot;</span> : <span class="s2">&quot;kinopoisk&quot;</span>,
      <span class="s2">&quot;_type&quot;</span> : <span class="s2">&quot;film&quot;</span>,
      <span class="s2">&quot;_id&quot;</span> : <span class="s2">&quot;AVWHmwbSTgOouHAvlXpi&quot;</span>,
      <span class="s2">&quot;_score&quot;</span> : <span class="m">0</span>.15342641,
      <span class="s2">&quot;fields&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;rate&quot;</span> : <span class="o">[</span> <span class="m">8</span>.042 <span class="o">]</span>,
        <span class="s2">&quot;id&quot;</span> : <span class="o">[</span> <span class="m">409640</span> <span class="o">]</span>
      <span class="o">}</span>
    <span class="o">}</span> <span class="o">]</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>–ü–æ–∏—Å–∫ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π:</p>
<div class="highlight"><pre><span></span>~$ curl -XGET <span class="s1">&#39;localhost:9200/kinopoisk/film/_search?pretty&#39;</span> -d <span class="o">{</span><span class="s1">&#39;</span>
<span class="s1">    &quot;fields&quot; : [&quot;id&quot;, &quot;rate&quot;],</span>
<span class="s1">    &quot;query&quot; : {</span>
<span class="s1">      &quot;query_string&quot; : {</span>
<span class="s1">        &quot;query&quot;:    &quot;—Å–∞–π–ª–æ–Ω*&quot;, </span>
<span class="s1">        &quot;fields&quot;: [ &quot;name&quot;, &quot;description&quot; ],</span>
<span class="s1">        &quot;default_operator&quot;: &quot;and&quot;</span>
<span class="s1">      }</span>
<span class="s1">    },</span>
<span class="s1">    &quot;highlight&quot; : {</span>
<span class="s1">      &quot;pre_tags&quot; : [&quot;[mazko.github.io]&quot;],</span>
<span class="s1">      &quot;post_tags&quot; : [&quot;[/mazko.github.io]&quot;],</span>
<span class="s1">      &quot;fields&quot; : {</span>
<span class="s1">        &quot;name&quot; : {&quot;fragment_size&quot; : 22, &quot;number_of_fragments&quot; : 1},</span>
<span class="s1">        &quot;description&quot; : {&quot;fragment_size&quot; : 22, &quot;number_of_fragments&quot; : 1}</span>
<span class="s1">      }</span>
<span class="s1">    }</span>
<span class="s1">}&#39;</span>
<span class="c1"># response</span>
<span class="o">{</span>
  <span class="s2">&quot;took&quot;</span> : <span class="m">218</span>,
  <span class="s2">&quot;timed_out&quot;</span> : false,
  <span class="s2">&quot;_shards&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;total&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;successful&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;failed&quot;</span> : <span class="m">0</span>
  <span class="o">}</span>,
  <span class="s2">&quot;hits&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;total&quot;</span> : <span class="m">1</span>,
    <span class="s2">&quot;max_score&quot;</span> : <span class="m">1</span>.0,
    <span class="s2">&quot;hits&quot;</span> : <span class="o">[</span> <span class="o">{</span>
      <span class="s2">&quot;_index&quot;</span> : <span class="s2">&quot;kinopoisk&quot;</span>,
      <span class="s2">&quot;_type&quot;</span> : <span class="s2">&quot;film&quot;</span>,
      <span class="s2">&quot;_id&quot;</span> : <span class="s2">&quot;AVWHnN7ATgOouHAvlXpl&quot;</span>,
      <span class="s2">&quot;_score&quot;</span> : <span class="m">1</span>.0,
      <span class="s2">&quot;fields&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;rate&quot;</span> : <span class="o">[</span> <span class="m">7</span>.943 <span class="o">]</span>,
        <span class="s2">&quot;id&quot;</span> : <span class="o">[</span> <span class="m">153013</span> <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">&quot;highlight&quot;</span> : <span class="o">{</span>
        <span class="s2">&quot;description&quot;</span> : <span class="o">[</span> <span class="s2">&quot; –Ω–∞–ø–∞–¥–µ–Ω–∏—è [mazko.github.io]–°–∞–π–ª–æ–Ω–æ–≤[/mazko.github.io]...&quot;</span> <span class="o">]</span>
      <span class="o">}</span>
    <span class="o">}</span> <span class="o">]</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>–°–∞–º–æ–µ –≤—Ä–µ–º—è –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö <a href="https://mazko.github.io/blog/posts/2016/05/20/lucene-avtozapolnenie-vvoda-polzovatelia/">–¥–∞–Ω–Ω—ã—Ö</a>:</p>
<div class="highlight"><pre><span></span>~: curl -XDELETE <span class="s1">&#39;localhost:9200/kinopoisk?pretty&#39;</span>

~: <span class="nb">time</span> python3 -c <span class="se">\</span>
  <span class="s1">&#39;import sys, json; [print(json.dumps(i, ensure_ascii=False)) for i in json.load(sys.stdin)]&#39;</span> <span class="se">\</span>
  &lt; Top.json <span class="p">|</span> xargs -d <span class="s1">&#39;\n&#39;</span> -n1 curl -XPOST <span class="s1">&#39;localhost:9200/kinopoisk/film/&#39;</span> -d

<span class="c1"># time</span>
real  18m52.728s
user  1m36.896s
sys   0m36.216s
</pre></div>


<p>–ü—Ä–æ—Ü–µ—Å—Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É—è <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html" rel="nofollow">Bulk API</a>:</p>
<div class="highlight"><pre><span></span>~: curl -XDELETE <span class="s1">&#39;localhost:9200/kinopoisk?pretty&#39;</span>

~: <span class="nb">time</span> python3 -c <span class="se">\</span>
  <span class="s1">&#39;import sys, json; [print(json.dumps({ &quot;index&quot; : { &quot;_index&quot; : &quot;kinopoisk&quot;, &quot;_type&quot; : &quot;film&quot; } }),</span>
<span class="s1">  &quot;\n&quot;, json.dumps(i, ensure_ascii=False)) for i in json.load(sys.stdin)]&#39;</span> <span class="se">\</span>
   &lt; Top.json <span class="p">|</span> curl -XPOST localhost:9200/_bulk --data-binary @-

<span class="c1"># time</span>
real  0m14.450s
user  0m1.044s
sys   0m0.196s
</pre></div>


<p>–ù–µ–º–Ω–æ–≥–æ –ø–æ–ª–µ–∑–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ–± –∏–Ω–¥–µ–∫—Å–µ:</p>
<div class="highlight"><pre><span></span>~: curl -XGET <span class="s1">&#39;localhost:9200/kinopoisk/_count?pretty&#39;</span>
<span class="c1"># response</span>
<span class="o">{</span>
  <span class="s2">&quot;count&quot;</span> : <span class="m">14999</span>,
  <span class="s2">&quot;_shards&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;total&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;successful&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;failed&quot;</span> : <span class="m">0</span>
  <span class="o">}</span>
<span class="o">}</span>

~: curl -XGET <span class="s1">&#39;localhost:9200/_cat/indices&#39;</span>
<span class="c1"># response</span>
yellow open kinopoisk <span class="m">5</span> <span class="m">1</span> <span class="m">14999</span> <span class="m">0</span> <span class="m">39</span>.1mb <span class="m">39</span>.1mb
</pre></div>


<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-suggesters-completion.html" rel="nofollow">Suggest</a> –≤ ElasticSearch –¥–æ–≤–æ–ª—å–Ω–æ —Å—Ç—Ä–∞–Ω–Ω—ã–π –ª–∏–±–æ –ø–ª–æ—Ö–æ –æ–ø–∏—Å–∞–Ω–Ω—ã–π:</p>
<div class="highlight"><pre><span></span>~: curl -XDELETE <span class="s1">&#39;localhost:9200/kinopoisk?pretty&#39;</span>

~: curl -XPUT <span class="s1">&#39;localhost:9200/kinopoisk?pretty&#39;</span> -d <span class="s1">&#39;{</span>
<span class="s1">  &quot;settings&quot;: {</span>
<span class="s1">    &quot;analysis&quot;: {</span>
<span class="s1">      &quot;filter&quot;: {</span>
<span class="s1">        &quot;shingle_filter&quot;: {</span>
<span class="s1">          &quot;type&quot;: &quot;shingle&quot;,</span>
<span class="s1">          &quot;max_shingle_size&quot;: &quot;5&quot;,</span>
<span class="s1">          &quot;min_shingle_size&quot;: &quot;2&quot;,</span>
<span class="s1">          &quot;output_unigrams&quot;:&quot;true&quot;</span>
<span class="s1">        }</span>
<span class="s1">      },</span>
<span class="s1">      &quot;analyzer&quot;: {</span>
<span class="s1">        &quot;pre_suggest_analyzer&quot;: {</span>
<span class="s1">          &quot;type&quot;: &quot;custom&quot;,</span>
<span class="s1">          &quot;tokenizer&quot;: &quot;standard&quot;,</span>
<span class="s1">          &quot;filter&quot;: [</span>
<span class="s1">            &quot;lowercase&quot;,</span>
<span class="s1">            &quot;shingle_filter&quot;</span>
<span class="s1">          ]</span>
<span class="s1">        }</span>
<span class="s1">      }</span>
<span class="s1">    }</span>
<span class="s1">  }</span>
<span class="s1">}&#39;</span>

~: curl -XGET <span class="s1">&#39;localhost:9200/kinopoisk/_analyze?pretty&#39;</span> -d <span class="s1">&#39;{</span>
<span class="s1">  &quot;analyzer&quot;: &quot;pre_suggest_analyzer&quot;,</span>
<span class="s1">  &quot;text&quot;: [&quot;—Ä–∞–∑ –¥–≤–∞&quot;, &quot;—Ä–∞–∑&quot;]</span>
<span class="s1">}&#39;</span>
<span class="c1">#response</span>
<span class="o">{</span>
  <span class="s2">&quot;tokens&quot;</span> : <span class="o">[</span> <span class="o">{</span>
    <span class="s2">&quot;token&quot;</span> : <span class="s2">&quot;—Ä–∞–∑&quot;</span>,
    <span class="s2">&quot;start_offset&quot;</span> : <span class="m">0</span>,
    <span class="s2">&quot;end_offset&quot;</span> : <span class="m">3</span>,
    <span class="s2">&quot;type&quot;</span> : <span class="s2">&quot;&lt;ALPHANUM&gt;&quot;</span>,
    <span class="s2">&quot;position&quot;</span> : <span class="m">0</span>
  <span class="o">}</span>, <span class="o">{</span>
    <span class="s2">&quot;token&quot;</span> : <span class="s2">&quot;—Ä–∞–∑ –¥–≤–∞&quot;</span>,
    <span class="s2">&quot;start_offset&quot;</span> : <span class="m">0</span>,
    <span class="s2">&quot;end_offset&quot;</span> : <span class="m">7</span>,
    <span class="s2">&quot;type&quot;</span> : <span class="s2">&quot;shingle&quot;</span>,
    <span class="s2">&quot;position&quot;</span> : <span class="m">0</span>
  <span class="o">}</span>, <span class="o">{</span>
    <span class="s2">&quot;token&quot;</span> : <span class="s2">&quot;–¥–≤–∞&quot;</span>,
    <span class="s2">&quot;start_offset&quot;</span> : <span class="m">4</span>,
    <span class="s2">&quot;end_offset&quot;</span> : <span class="m">7</span>,
    <span class="s2">&quot;type&quot;</span> : <span class="s2">&quot;&lt;ALPHANUM&gt;&quot;</span>,
    <span class="s2">&quot;position&quot;</span> : <span class="m">1</span>
  <span class="o">}</span>, <span class="o">{</span>
    <span class="s2">&quot;token&quot;</span> : <span class="s2">&quot;—Ä–∞–∑&quot;</span>,
    <span class="s2">&quot;start_offset&quot;</span> : <span class="m">8</span>,
    <span class="s2">&quot;end_offset&quot;</span> : <span class="m">11</span>,
    <span class="s2">&quot;type&quot;</span> : <span class="s2">&quot;&lt;ALPHANUM&gt;&quot;</span>,
    <span class="s2">&quot;position&quot;</span> : <span class="m">102</span>
  <span class="o">}</span> <span class="o">]</span>
<span class="o">}</span>
</pre></div>


<p>–ò—Å—Ö–æ–¥—è –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–µ—Å–æ–≤—Å–µ–º –ø–æ–Ω—è—Ç–Ω–æ –∫–∞–∫ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫—É—é —à—Ç—É–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –±–µ–∑ –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ <em>localhost:9200/kinopoisk/_analyze</em>:</p>
<div class="highlight"><pre><span></span>~: python3 -c <span class="s1">&#39;</span>
<span class="s1">import sys, json</span>
<span class="s1">from urllib.request import urlopen</span>

<span class="s1">def get_shingles(*args):</span>
<span class="s1">  data = { &quot;analyzer&quot;: &quot;pre_suggest_analyzer&quot;, &quot;text&quot;: args }</span>
<span class="s1">  data = json.dumps(data).encode(&quot;utf8&quot;)</span>
<span class="s1">  with urlopen(&quot;http://localhost:9200/kinopoisk/_analyze&quot;, data=data) as r:</span>
<span class="s1">    data = json.loads(r.read().decode(r.info().get_param(&quot;charset&quot;) or &quot;utf-8&quot;))</span>
<span class="s1">    tokens = map(lambda v: v[&quot;token&quot;], data[&quot;tokens&quot;])</span>
<span class="s1">    tokens = filter(lambda v: len(v) &gt; 1, tokens)</span>
<span class="s1">    return list(set(tokens))</span>

<span class="s1">for film in { obj[&quot;id&quot;]: obj for obj in json.load(sys.stdin) }.values():</span>
<span class="s1">  film[&quot;rate&quot;] = float(film[&quot;rate&quot;])</span>
<span class="s1">  film[&quot;suggest&quot;] = { &quot;input&quot;: get_shingles(film[&quot;name&quot;], film[&quot;description&quot;]) }</span>
<span class="s1">  print(json.dumps({ &quot;index&quot; : { &quot;_index&quot; : &quot;kinopoisk&quot;, &quot;_type&quot; : &quot;film&quot;, &quot;_id&quot; : film[&quot;id&quot;]} })) </span>
<span class="s1">  print(json.dumps(film, ensure_ascii=False))</span>
<span class="s1">&#39;</span> &lt; Top.json <span class="p">|</span> xz --extreme -9 &gt; Top.bulk.json.xz
</pre></div>


<p>–ò–Ω–¥–µ–∫—Å —É–∂–µ —Å Suggest:</p>
<div class="highlight"><pre><span></span>~: curl -XDELETE <span class="s1">&#39;localhost:9200/kinopoisk?pretty&#39;</span>

~: curl -XPUT <span class="s1">&#39;localhost:9200/kinopoisk?pretty&#39;</span> -d <span class="s1">&#39;{</span>
<span class="s1">  &quot;mappings&quot;: {</span>
<span class="s1">    &quot;film&quot; : {</span>
<span class="s1">      &quot;properties&quot; : {</span>
<span class="s1">        &quot;suggest&quot; : { </span>
<span class="s1">          &quot;type&quot; : &quot;completion&quot;,</span>
<span class="s1">          &quot;analyzer&quot;: &quot;standard&quot;</span>
<span class="s1">          }</span>
<span class="s1">        }</span>
<span class="s1">      }</span>
<span class="s1">    }</span>
<span class="s1">  }</span>
<span class="s1">}&#39;</span>

~: xzcat Top.bulk.json.xz <span class="p">|</span> curl -XPOST localhost:9200/_bulk --data-binary @-

~: curl -XGET <span class="s1">&#39;localhost:9200/kinopoisk/_suggest?pretty&#39;</span> -d <span class="s1">&#39;{</span>
<span class="s1">  &quot;film-suggest&quot; : {</span>
<span class="s1">    &quot;text&quot; : &quot;—à–µ—Ä–ª–æ–∫ &quot;,</span>
<span class="s1">    &quot;completion&quot; : {</span>
<span class="s1">        &quot;field&quot; : &quot;suggest&quot;,</span>
<span class="s1">        &quot;size&quot;: 5</span>
<span class="s1">    }</span>
<span class="s1">  }</span>
<span class="s1">}&#39;</span>
<span class="c1">#response</span>
<span class="o">{</span>
  <span class="s2">&quot;_shards&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;total&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;successful&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;failed&quot;</span> : <span class="m">0</span>
  <span class="o">}</span>,
  <span class="s2">&quot;film-suggest&quot;</span> : <span class="o">[</span> <span class="o">{</span>
    <span class="s2">&quot;text&quot;</span> : <span class="s2">&quot;—à–µ—Ä–ª–æ–∫ &quot;</span>,
    <span class="s2">&quot;offset&quot;</span> : <span class="m">0</span>,
    <span class="s2">&quot;length&quot;</span> : <span class="m">7</span>,
    <span class="s2">&quot;options&quot;</span> : <span class="o">[</span> <span class="o">{</span>
      <span class="s2">&quot;text&quot;</span> : <span class="s2">&quot;—à–µ—Ä–ª–æ–∫ —Ö–æ–ª–º—Å&quot;</span>,
      <span class="s2">&quot;score&quot;</span> : <span class="m">3</span>.0
    <span class="o">}</span>, <span class="o">{</span>
      <span class="s2">&quot;text&quot;</span> : <span class="s2">&quot;—à–µ—Ä–ª–æ–∫ —Ö–æ–ª–º—Å –∏&quot;</span>,
      <span class="s2">&quot;score&quot;</span> : <span class="m">2</span>.0
    <span class="o">}</span>, <span class="o">{</span>
      <span class="s2">&quot;text&quot;</span> : <span class="s2">&quot;—à–µ—Ä–ª–æ–∫ —Ö–æ–ª–º—Å –∏ –¥–æ–∫—Ç–æ—Ä&quot;</span>,
      <span class="s2">&quot;score&quot;</span> : <span class="m">2</span>.0
    <span class="o">}</span>, <span class="o">{</span>
      <span class="s2">&quot;text&quot;</span> : <span class="s2">&quot;—à–µ—Ä–ª–æ–∫ —Ö–æ–ª–º—Å –∏ –¥–æ–∫—Ç–æ—Ä –≤–∞—Ç—Å–æ–Ω&quot;</span>,
      <span class="s2">&quot;score&quot;</span> : <span class="m">2</span>.0
    <span class="o">}</span>, <span class="o">{</span>
      <span class="s2">&quot;text&quot;</span> : <span class="s2">&quot;—à–µ—Ä–ª–æ–∫ –º–ª–∞–¥—à–∏–π&quot;</span>,
      <span class="s2">&quot;score&quot;</span> : <span class="m">1</span>.0
    <span class="o">}</span> <span class="o">]</span>
  <span class="o">}</span> <span class="o">]</span>
<span class="o">}</span>
</pre></div>


<p>–ü–æ–∏—Å–∫ —Å <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket-terms-aggregation.html" rel="nofollow">–∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π</a> –ø–æ –ø–æ–ª—é <em>starring</em>:</p>
<div class="highlight"><pre><span></span>~$ curl -XDELETE <span class="s1">&#39;localhost:9200/kinopoisk?pretty&#39;</span>

~$ curl -XPUT <span class="s1">&#39;localhost:9200/kinopoisk?pretty&#39;</span> -d <span class="s1">&#39;{</span>
<span class="s1">  &quot;mappings&quot;: {</span>
<span class="s1">    &quot;film&quot; : {</span>
<span class="s1">      &quot;properties&quot; : {</span>
<span class="s1">        &quot;starring&quot;: {</span>
<span class="s1">          &quot;type&quot;: &quot;string&quot;,</span>
<span class="s1">          &quot;fields&quot;: {</span>
<span class="s1">              &quot;raw&quot;: {</span>
<span class="s1">                  &quot;type&quot;: &quot;string&quot;,</span>
<span class="s1">                  &quot;index&quot;: &quot;not_analyzed&quot;</span>
<span class="s1">              }</span>
<span class="s1">          }</span>
<span class="s1">        }</span>
<span class="s1">      }</span>
<span class="s1">    }</span>
<span class="s1">  }</span>
<span class="s1">}&#39;</span>

~$ xzcat Top.bulk.json.xz <span class="p">|</span> curl -XPOST localhost:9200/_bulk --data-binary @-

~$ curl -XGET <span class="s1">&#39;localhost:9200/kinopoisk/film/_search?pretty&#39;</span> -d <span class="o">{</span><span class="s1">&#39;</span>
<span class="s1">  &quot;size&quot;: 0,</span>
<span class="s1">  &quot;query&quot; : {</span>
<span class="s1">    &quot;query_string&quot; : {</span>
<span class="s1">      &quot;query&quot;:    &quot;—à–µ—Ä–ª–æ–∫&quot;, </span>
<span class="s1">      &quot;fields&quot;: [ &quot;name&quot;, &quot;description&quot; ],</span>
<span class="s1">      &quot;default_operator&quot;: &quot;and&quot;</span>
<span class="s1">    }</span>
<span class="s1">  },</span>
<span class="s1">  &quot;aggs&quot;: {</span>
<span class="s1">    &quot;stars&quot; : {</span>
<span class="s1">      &quot;terms&quot; : { &quot;field&quot; : &quot;starring.raw&quot;, &quot;size&quot;: 10 }</span>
<span class="s1">    }</span>
<span class="s1">  }</span>
<span class="s1">}&#39;</span>
<span class="c1"># response</span>
<span class="o">{</span>
  <span class="s2">&quot;took&quot;</span> : <span class="m">1103</span>,
  <span class="s2">&quot;timed_out&quot;</span> : false,
  <span class="s2">&quot;_shards&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;total&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;successful&quot;</span> : <span class="m">5</span>,
    <span class="s2">&quot;failed&quot;</span> : <span class="m">0</span>
  <span class="o">}</span>,
  <span class="s2">&quot;hits&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;total&quot;</span> : <span class="m">16</span>,
    <span class="s2">&quot;max_score&quot;</span> : <span class="m">0</span>.0,
    <span class="s2">&quot;hits&quot;</span> : <span class="o">[</span> <span class="o">]</span>
  <span class="o">}</span>,
  <span class="s2">&quot;aggregations&quot;</span> : <span class="o">{</span>
    <span class="s2">&quot;stars&quot;</span> : <span class="o">{</span>
      <span class="s2">&quot;doc_count_error_upper_bound&quot;</span> : <span class="m">1</span>,
      <span class="s2">&quot;sum_other_doc_count&quot;</span> : <span class="m">122</span>,
      <span class="s2">&quot;buckets&quot;</span> : <span class="o">[</span> <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–í–∞—Å–∏–ª–∏–π –õ–∏–≤–∞–Ω–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">7</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–í–∏—Ç–∞–ª–∏–π –°–æ–ª–æ–º–∏–Ω&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">7</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–†–∏–Ω–∞ –ó–µ–ª–µ–Ω–∞—è&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">7</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ë–æ—Ä–∏—Å–ª–∞–≤ –ë—Ä–æ–Ω–¥—É–∫–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">6</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ë–æ—Ä–∏—Å –ö–ª—é–µ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">4</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ó–∞—Ö–∞—Ä–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–ê–ª–µ–∫—Å–µ–π –ö–æ–∂–µ–≤–Ω–∏–∫–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–í–∞–ª–µ–Ω—Ç–∏–Ω–∞ –ü–∞–Ω–∏–Ω–∞&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–í–∏–∫—Ç–æ—Ä –ï–≤–≥—Ä–∞—Ñ–æ–≤&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
      <span class="o">}</span>, <span class="o">{</span>
        <span class="s2">&quot;key&quot;</span> : <span class="s2">&quot;–î–∂–µ—Ä–∞–ª—å–¥–∏–Ω –î–∂–µ–π–º—Å&quot;</span>,
        <span class="s2">&quot;doc_count&quot;</span> : <span class="m">2</span>
      <span class="o">}</span> <span class="o">]</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
    </div><!-- /.entry-content -->
  </article>
</section>


<div class="body" id="proiot-comments">
  <div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'mazko';
      var disqus_identifier = 'blog/posts/2016/06/25/elasticsearch-prakticheskoe-vvedenie/';
      var disqus_url = 'https://mazko.github.io/blog/posts/2016/06/25/elasticsearch-prakticheskoe-vvedenie/';
      (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//mazko.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the comments.</noscript>
  </div>
</div>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a rel="nofollow" href="http://getpelican.com/">Pelican</a></li>
                            <li><a rel="nofollow" href="http://python.org/">Python.org</a></li>
                            <li><a rel="nofollow" href="http://jinja.pocoo.org/">Jinja2</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://mazko.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a rel="nofollow" href="http://github.com/mazko">github</a></li>
                            <li><a rel="nofollow" href="http://linkedin.com/in/mazko">linkedin</a></li>
                            <li><a rel="nofollow" href="http://stackoverflow.com/users/281102/oleg-mazko">stackoverflow</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'mazko';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>