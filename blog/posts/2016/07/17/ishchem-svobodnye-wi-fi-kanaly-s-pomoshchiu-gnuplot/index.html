<!DOCTYPE html>
<html lang="ru">
<head>
        <meta charset="utf-8" />
        <title>–ò—â–µ–º —Å–≤–æ–±–æ–¥–Ω—ã–µ Wi-Fi –∫–∞–Ω–∞–ª—ã —Å –ø–æ–º–æ—â—å—é GnuPlot</title>
        <link rel="stylesheet" href="https://mazko.github.io/blog/theme/css/main.css" />
        <link href="https://mazko.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="üè† –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –í—Å–µ–≥–æ üöó Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
<a rel="nofollow" href="http://github.com/mazko">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="https://mazko.github.io/">üè† –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –í—Å–µ–≥–æ üöó </a></h1>
                <nav><ul>
                    <li><a href="https://mazko.github.io/blog/category/admin/">Admin</a></li>
                    <li><a href="https://mazko.github.io/blog/category/electronics/">Electronics</a></li>
                    <li><a href="https://mazko.github.io/blog/category/embedded/">Embedded</a></li>
                    <li class="active"><a href="https://mazko.github.io/blog/category/iot/">IoT</a></li>
                    <li><a href="https://mazko.github.io/blog/category/java/">Java</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://mazko.github.io/blog/posts/2016/07/17/ishchem-svobodnye-wi-fi-kanaly-s-pomoshchiu-gnuplot/" rel="bookmark"
           title="Permalink to –ò—â–µ–º —Å–≤–æ–±–æ–¥–Ω—ã–µ Wi-Fi –∫–∞–Ω–∞–ª—ã —Å –ø–æ–º–æ—â—å—é GnuPlot">–ò—â–µ–º —Å–≤–æ–±–æ–¥–Ω—ã–µ Wi-Fi –∫–∞–Ω–∞–ª—ã —Å –ø–æ–º–æ—â—å—é GnuPlot</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-07-17T00:00:00+03:00">
                –í—Å 17 –∏—é–ª—è 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://mazko.github.io/blog/author/oleg-mazko/">Oleg Mazko</a>
        </address>
<p>In <a href="https://mazko.github.io/blog/category/iot/">IoT</a>.</p>
<p>tags: <a href="https://mazko.github.io/blog/tag/gnuplot">GnuPlot</a> <a href="https://mazko.github.io/blog/tag/wi-fi">Wi-Fi</a> </p>
</footer><!-- /.post-info -->      <p>–í —ç–ø–æ—Ö—É –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ Wi-Fi –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä—ã —É–∂–µ –¥–∞–≤–Ω–æ —Å—Ç–∞–ª–∏ –Ω–µ–∑–∞–º–µ–Ω–∏–º–æ–π —á–∞—Å—Ç—å—é –Ω–∞—à–µ–≥–æ –±—ã—Ç–∏—è. Wi-Fi —Å–µ—Ç–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 2,4 GHz –ª–∏–±–æ 5 GHz –∏ –º–æ–≥—É—Ç –≤–∑–∞–∏–º–Ω–æ –º–µ—à–∞—Ç—å —Ä–∞–±–æ—Ç–µ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ —É –≤–∞—à–µ–≥–æ —Å–æ—Å–µ–¥–∞ —Ç–æ–∂–µ —Å—Ç–æ–∏—Ç —Ä–æ—É—Ç–µ—Ä –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ç–∞–∫–æ–π –∂–µ —á–∞—Å—Ç–æ—Ç–µ —á—Ç–æ –∏ –≤–∞—à. –î–ª—è —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞–µ–≤ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–æ—É—Ç–µ—Ä–∞ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ —Å–µ—Ç–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ 1-13 (2.412GHz-2.472GHz). –°–æ—Å–µ–¥–µ–π –º–Ω–æ–≥–æ, –≤—Å–µ–º –Ω—É–∂–µ–Ω —Ö–æ—Ä–æ—à–∏–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç. –í –¥–∞–Ω–Ω–æ–º –º–∞—Ç–µ—Ä–∏–∞–ª–µ –º—ã –Ω–∞—É—á–∏–º—Å—è —Ä–∏—Å–æ–≤–∞—Ç—å –≤–æ—Ç —Ç–∞–∫—É—é –∫—Ä–∞—Å–∏–≤—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É –±–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –ü–û, —Ç.–µ. –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ Linux –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ <a href="http://www.gnuplot.info/" rel="nofollow">gnuplot</a>.</p>
<h2>TL;DR</h2>
<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2016/07/17/ishchem-svobodnye-wi-fi-kanaly-s-pomoshchiu-gnuplot/shot.png" style="width:100%; border:1px solid #ddd;"></p>
<div class="highlight"><pre><span></span>~$ sudo iwlist wlo1 scanning <span class="p">|</span> python3 -c <span class="s1">&#39;</span>

<span class="s1">import re,sys</span>

<span class="s1">def tokenize(code):</span>
<span class="s1">    token_specification = [</span>
<span class="s1">        (&quot;CELL&quot;,  r&quot;^\s+Cell \d+&quot;),</span>
<span class="s1">        (&quot;FREQ&quot;,  r&quot;^\s+Frequency:(\d+(\.\d*)?)&quot;),</span>
<span class="s1">        (&quot;CHNL&quot;,  r&quot;^\s+Channel:(\d+)&quot;),</span>
<span class="s1">        (&quot;ESSID&quot;, r&quot;^\s+ESSID:\&quot;([- A-Za-z0-9$@^`,|%;.~()/\\{}:?[\]=+_#!]*)\&quot;&quot;),</span>
<span class="s1">        (&quot;LEVEL&quot;, r&quot;\s+Signal level=(-\d+)&quot;),</span>
<span class="s1">    ]</span>
<span class="s1">    tok_regex = &quot;|&quot;.join(&quot;(?P&lt;%s&gt;%s)&quot; % pair for pair in token_specification)</span>

<span class="s1">    for mo in re.finditer(tok_regex, code, re.M):</span>
<span class="s1">        typ = mo.lastgroup</span>
<span class="s1">        if typ == &quot;CELL&quot;:</span>
<span class="s1">            if &quot;res&quot; in vars() and res:</span>
<span class="s1">                yield res</span>
<span class="s1">            res = {}</span>
<span class="s1">        else:</span>
<span class="s1">            grs = [v for v in mo.groups() if v not in [mo.group(typ), None]]</span>
<span class="s1">            assert len(grs), &quot;Forgot capture value for %s ?&quot; % typ</span>
<span class="s1">            res[typ] = grs[0]</span>
<span class="s1">    if res:</span>
<span class="s1">        yield res</span>

<span class="s1">data = list(tokenize(sys.stdin.read()))</span>

<span class="s1">print(</span>
<span class="s1">&quot;&quot;&quot;</span>
<span class="s1"># legend</span>
<span class="s1">set key top left outside horizontal</span>
<span class="s1">set xlabel &quot;Channel&quot;</span>
<span class="s1">set ylabel &quot;Strength (dbm)&quot;</span>
<span class="s1"># x axis step</span>
<span class="s1">set xtics 1</span>
<span class="s1"># show horizontal grid lines </span>
<span class="s1">set grid ytics</span>
<span class="s1">set xrange [-2:16]</span>
<span class="s1">set yrange [%(bottom)d - 0.1:%(top)d]</span>
<span class="s1">set term png truecolor size 1280,720</span>
<span class="s1">plot for [IDX=0:%(total)d-1] &quot;-&quot; \</span>
<span class="s1">    using 2:(%(bottom)d):(4):(2*abs(%(bottom)d - $1)) \</span>
<span class="s1">    title columnheader(1) with ellipses \</span>
<span class="s1">    fill transparent solid 0.5 </span>
<span class="s1">&quot;&quot;&quot; </span>
<span class="s1">% {</span>
<span class="s1">    &quot;total&quot;: len(data), </span>
<span class="s1">    &quot;top&quot;: max([int(tok[&quot;LEVEL&quot;]) for tok in data]) + 1, </span>
<span class="s1">    &quot;bottom&quot;: min([int(tok[&quot;LEVEL&quot;]) for tok in data]) - 5, </span>
<span class="s1">})</span>

<span class="s1">for tok in data:</span>
<span class="s1">    print(&quot;\&quot;%s\&quot;&quot; % (tok[&quot;ESSID&quot;] or &quot;&lt;HIDDEN&gt;&quot;))</span>
<span class="s1">    print(tok[&quot;LEVEL&quot;], tok[&quot;CHNL&quot;])</span>
<span class="s1">    print(&quot;e&quot;)</span>
<span class="s1">    assert set((&quot;FREQ&quot;,&quot;CHNL&quot;,&quot;ESSID&quot;, &quot;LEVEL&quot;)) &lt;= set(tok)</span>
<span class="s1">&#39;</span> <span class="p">|</span> gnuplot &gt; out.png
</pre></div>


<p>–ß–∞—Å—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –≤–∏–¥–µ—Ç—å –≥—Ä–∞—Ñ–∏–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ <code>while sleep 10; do sudo iwlist wlo1 scanning | python3 wifi.plot.py | gnuplot &gt; out.png; done</code> –∏ –∫–∞–∫–æ–π –Ω–∏–±—É–¥—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä—â–∏–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–∏–ø–∞ <code>feh  --reload 1 out.png</code></p>
<h2>GNUPLOT</h2>
<p>–í gnuplot –º–æ–∂–Ω–æ —Ä–∏—Å–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –∫–∞–∫ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–π —Ç–∞–∫ –∏ –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º —Ç–æ—á–∫–∞–º. –ù–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç:</p>
<div class="highlight"><pre><span></span>~$ gnuplot --version
gnuplot <span class="m">4</span>.6 patchlevel <span class="m">6</span>
~$ <span class="nb">echo</span> <span class="s1">&#39;</span>
<span class="s1">plot for [IDX=0:1] &quot;-&quot; using 1:2 title columnheader(1) with lines</span>
<span class="s1">hello</span>
<span class="s1">1 1</span>
<span class="s1">3 3</span>
<span class="s1">e</span>
<span class="s1">world</span>
<span class="s1">1 3</span>
<span class="s1">3 1</span>
<span class="s1">e</span>
<span class="s1">&#39;</span> <span class="p">|</span> gnuplot -p
</pre></div>


<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2016/07/17/ishchem-svobodnye-wi-fi-kanaly-s-pomoshchiu-gnuplot/hello.png" style="width:100%; border:1px solid #ddd;"></p>
<div class="highlight"><pre><span></span>~$ <span class="nb">echo</span> <span class="s1">&#39;</span>
<span class="s1">set term png truecolor size 1280,480</span>
<span class="s1">set xrange [0:6]</span>
<span class="s1">plot for [IDX=0:3] &quot;-&quot; using 2:1 title columnheader(1) with points pointsize 3</span>
<span class="s1">&quot;Anna&quot;</span>
<span class="s1">-93 1</span>
<span class="s1">e</span>
<span class="s1">&quot;Erika&quot;</span>
<span class="s1">-73 1</span>
<span class="s1">e</span>
<span class="s1">&quot;Alina&quot;</span>
<span class="s1">-84 1</span>
<span class="s1">e</span>
<span class="s1">&quot;Nast&quot;</span>
<span class="s1">-93 5</span>
<span class="s1">e</span>
<span class="s1">&#39;</span> <span class="p">|</span> gnuplot &gt; wifi.points.png
</pre></div>


<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2016/07/17/ishchem-svobodnye-wi-fi-kanaly-s-pomoshchiu-gnuplot/wifi.points.png" style="width:100%; border:1px solid #ddd;"></p>
<div class="highlight"><pre><span></span>~$ <span class="nb">echo</span> <span class="s1">&#39;</span>
<span class="s1">set term png truecolor size 1280,480</span>
<span class="s1">set xlabel &quot;Channel&quot;</span>
<span class="s1">set ylabel &quot;Strength (dbm)&quot;</span>
<span class="s1">set xrange [0:6]</span>
<span class="s1">set yrange [-110:-60]</span>
<span class="s1">set grid ytics</span>
<span class="s1">plot for [IDX=0:3] &quot;-&quot; using 2:1:(2):(abs($1/3)) title columnheader(1) with ellipses</span>
<span class="s1">&quot;Anna&quot;</span>
<span class="s1">-93 1</span>
<span class="s1">e</span>
<span class="s1">&quot;Erika&quot;</span>
<span class="s1">-73 1</span>
<span class="s1">e</span>
<span class="s1">&quot;Alina&quot;</span>
<span class="s1">-84 1</span>
<span class="s1">e</span>
<span class="s1">&quot;Nast&quot;</span>
<span class="s1">-93 5</span>
<span class="s1">e</span>
<span class="s1">&#39;</span> <span class="p">|</span> gnuplot &gt; wifi.ellipses.png
</pre></div>


<p><img alt="screenshot" src="https://mazko.github.io/blog/posts/2016/07/17/ishchem-svobodnye-wi-fi-kanaly-s-pomoshchiu-gnuplot/wifi.ellipses.png" style="width:100%; border:1px solid #ddd;"></p>
<p>–ú—ã –≤–≤–µ–ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤—ã—Å–æ—Ç—ã —ç–ª–ª–∏–ø—Å–∞ –æ—Ç —É—Ä–æ–≤–Ω—è —Å–∏–≥–Ω–∞–ª–∞. –û—Å—Ç–∞–ª–æ—Å—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –µ—ë –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å, –∑–∞–∫—Ä–∞—Å–∏—Ç—å –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é –∏ –æ–ø—É—Å—Ç–∏—Ç—å –≤–Ω–∏–∑ –Ω–∞ –ø–æ–ª–æ–≤–∏–Ω—É. –¢–∞–∫–∂–µ gnuplot –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ—á–∫–∏, –Ω–∞—Ö–æ–¥—è—â–∏–µ—Å—è –∑–∞ –ø—Ä–µ–¥–∞–ª–∞–º–∏ xrange, yrange - –ø–æ—ç—Ç–æ–º—É –∫ yrange –¥–ª—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ –ø—Ä–∏–±–∞–≤–ª–µ–Ω–æ ~0.1</p>
    </div><!-- /.entry-content -->
  </article>
</section>


<div class="body" id="proiot-comments">
  <div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'mazko';
      var disqus_identifier = 'blog/posts/2016/07/17/ishchem-svobodnye-wi-fi-kanaly-s-pomoshchiu-gnuplot/';
      var disqus_url = 'https://mazko.github.io/blog/posts/2016/07/17/ishchem-svobodnye-wi-fi-kanaly-s-pomoshchiu-gnuplot/';
      (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//mazko.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the comments.</noscript>
  </div>
</div>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a rel="nofollow" href="http://getpelican.com/">Pelican</a></li>
                            <li><a rel="nofollow" href="http://python.org/">Python.org</a></li>
                            <li><a rel="nofollow" href="http://jinja.pocoo.org/">Jinja2</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://mazko.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a rel="nofollow" href="http://github.com/mazko">github</a></li>
                            <li><a rel="nofollow" href="http://linkedin.com/in/mazko">linkedin</a></li>
                            <li><a rel="nofollow" href="http://stackoverflow.com/users/281102/oleg-mazko">stackoverflow</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'mazko';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>